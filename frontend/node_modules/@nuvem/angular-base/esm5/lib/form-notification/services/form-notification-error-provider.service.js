import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { HttpErrorResponse } from '@angular/common/http';
import { FormNotificationService } from './form-notification.service';
import { FieldFormNotification } from '../types/field-form-notification.type';
import * as i0 from "@angular/core";
import * as i1 from "./form-notification.service";
/**
 * Provedor de error para criação de erros de notificação.
 * @class
 */
import * as ɵngcc0 from '@angular/core';
var FormNotificationErrorProvider = /** @class */ (function () {
    /**
     * Método construtor
     * @param {FormtNotificationService} formNotificationService
     * @constructor
     */
    function FormNotificationErrorProvider(formNotificationService) {
        this.formNotificationService = formNotificationService;
    }
    /**
     * Método responsável pela identificação de erros
     * @public
     * @param {Error | HttpErrorResponse} error
     * @returns Boolean
     */
    FormNotificationErrorProvider.prototype.shouldHandle = function (error) {
        return error instanceof HttpErrorResponse &&
            error.headers.get('Content-Type') === 'application/problem+json' &&
            error.error && (error.error.violations || error.error.fieldErrors);
    };
    /**
     * Método para emissão de erros
     * @public
     * @param {HttpErrorResponse} error
     * @returns void
     */
    FormNotificationErrorProvider.prototype.handle = function (error) {
        if (error.error.violations) {
            this.violation(error.url, error.error.violations);
        }
        if (error.error.fieldErrors) {
            this.violation(error.url, error.error.fieldErrors);
        }
    };
    /**
     * Método iteração de violações e emissão de erros
     * @param values
     */
    FormNotificationErrorProvider.prototype.violation = function (form, values) {
        var _this = this;
        values.forEach(function (violation) {
            return _this.formNotificationService.notify(new FieldFormNotification(form, violation.field, violation.message));
        });
    };
    FormNotificationErrorProvider.ctorParameters = function () { return [
        { type: FormNotificationService }
    ]; };
    FormNotificationErrorProvider.ɵprov = i0.ɵɵdefineInjectable({ factory: function FormNotificationErrorProvider_Factory() { return new FormNotificationErrorProvider(i0.ɵɵinject(i1.FormNotificationService)); }, token: FormNotificationErrorProvider, providedIn: "root" });
FormNotificationErrorProvider.ɵfac = function FormNotificationErrorProvider_Factory(t) { return new (t || FormNotificationErrorProvider)(ɵngcc0.ɵɵinject(FormNotificationService)); };
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(FormNotificationErrorProvider, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: FormNotificationService }]; }, null); })();
    return FormNotificationErrorProvider;
}());
export { FormNotificationErrorProvider };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1ub3RpZmljYXRpb24tZXJyb3ItcHJvdmlkZXIuc2VydmljZS5qcyIsInNvdXJjZXMiOlsibmc6L0BudXZlbS9hbmd1bGFyLWJhc2UvbGliL2Zvcm0tbm90aWZpY2F0aW9uL3NlcnZpY2VzL2Zvcm0tbm90aWZpY2F0aW9uLWVycm9yLXByb3ZpZGVyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDekQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFdEUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDOUU7QUFFZ0M7QUFEaEM7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFJSDtBQUFpRSxJQUU3RDtBQUNKO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxJQUFJLHVDQUFvQix1QkFBZ0Q7QUFBSSxRQUFwRCw0QkFBdUIsR0FBdkIsdUJBQXVCLENBQXlCO0FBQUMsSUFBRyxDQUFDO0FBQzdFLElBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxJQUFJLG9EQUFZLEdBQVosVUFBYSxLQUFnQztBQUFJLFFBQzdDLE9BQU8sS0FBSyxZQUFZLGlCQUFpQjtBQUNqRCxZQUFZLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxLQUFLLDBCQUEwQjtBQUM1RSxZQUFZLEtBQUssQ0FBQyxLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFVBQVUsSUFBSSxLQUFLLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQy9FLElBQUksQ0FBQztBQUVMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxJQUFJLDhDQUFNLEdBQU4sVUFBTyxLQUF3QjtBQUFJLFFBQy9CLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUU7QUFDcEMsWUFBWSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUM5RCxTQUFTO0FBQ1QsUUFBUSxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFO0FBQ3JDLFlBQVksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDL0QsU0FBUztBQUNULElBQUksQ0FBQztBQUVMLElBQUk7QUFDSjtBQUNBO0FBQ0EsT0FBTztBQUNQLElBQUksaURBQVMsR0FBVCxVQUFVLElBQVksRUFBRSxNQUE4QztBQUMxRSxRQURJLGlCQUtDO0FBQ0wsUUFMUSxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUEsU0FBUztBQUNoQyxZQUFZLE9BQUEsS0FBSSxDQUFDLHVCQUF1QixDQUFDLE1BQU0sQ0FDL0IsSUFBSSxxQkFBcUIsQ0FDckIsSUFBSSxFQUFFLFNBQVMsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQUUsUUFGcEQsQ0FFa0QsQ0FBQyxDQUFDO0FBQ2hFLElBQUksQ0FBQztBQUVMO0FBQ3dFLGdCQXpDdkIsdUJBQXVCO0FBQUc7QUFFckU7SUFUTyw2QkFBNkIsd0JBSHpDLFVBQVUsQ0FBQyxjQUNSLFVBQVUsRUFBRSxNQUFNLFdBQ3JCLENBQUMsUUFDVyw2QkFBNkIsQ0ErQ3pDOzs7Ozs7aUZBQ0Q7QUFBQyx3Q0E3REQ7QUFBRSxDQTRERCxBQS9DRCxJQStDQztBQUNELFNBaERhLDZCQUE2QjtBQUFJIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cEVycm9yUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBGb3JtTm90aWZpY2F0aW9uU2VydmljZSB9IGZyb20gJy4vZm9ybS1ub3RpZmljYXRpb24uc2VydmljZSc7XG5pbXBvcnQgeyBFcnJvclByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vZXJyb3IvcHJvdmlkZXJzL2Vycm9yLnByb3ZpZGVyJztcbmltcG9ydCB7IEZpZWxkRm9ybU5vdGlmaWNhdGlvbiB9IGZyb20gJy4uL3R5cGVzL2ZpZWxkLWZvcm0tbm90aWZpY2F0aW9uLnR5cGUnO1xuXG4vKipcbiAqIFByb3ZlZG9yIGRlIGVycm9yIHBhcmEgY3JpYcOnw6NvIGRlIGVycm9zIGRlIG5vdGlmaWNhw6fDo28uXG4gKiBAY2xhc3NcbiAqL1xuQEluamVjdGFibGUoe1xuICAgIHByb3ZpZGVkSW46ICdyb290Jyxcbn0pXG5leHBvcnQgY2xhc3MgRm9ybU5vdGlmaWNhdGlvbkVycm9yUHJvdmlkZXIgaW1wbGVtZW50cyBFcnJvclByb3ZpZGVyIHtcblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gY29uc3RydXRvclxuICAgICAqIEBwYXJhbSB7Rm9ybXROb3RpZmljYXRpb25TZXJ2aWNlfSBmb3JtTm90aWZpY2F0aW9uU2VydmljZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZm9ybU5vdGlmaWNhdGlvblNlcnZpY2U6IEZvcm1Ob3RpZmljYXRpb25TZXJ2aWNlKSB7IH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcmVzcG9uc8OhdmVsIHBlbGEgaWRlbnRpZmljYcOnw6NvIGRlIGVycm9zXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7RXJyb3IgfCBIdHRwRXJyb3JSZXNwb25zZX0gZXJyb3JcbiAgICAgKiBAcmV0dXJucyBCb29sZWFuXG4gICAgICovXG4gICAgc2hvdWxkSGFuZGxlKGVycm9yOiBFcnJvciB8IEh0dHBFcnJvclJlc3BvbnNlKTogQm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBlcnJvciBpbnN0YW5jZW9mIEh0dHBFcnJvclJlc3BvbnNlICYmXG4gICAgICAgICAgICBlcnJvci5oZWFkZXJzLmdldCgnQ29udGVudC1UeXBlJykgPT09ICdhcHBsaWNhdGlvbi9wcm9ibGVtK2pzb24nICYmXG4gICAgICAgICAgICBlcnJvci5lcnJvciAmJiAoZXJyb3IuZXJyb3IudmlvbGF0aW9ucyB8fCBlcnJvci5lcnJvci5maWVsZEVycm9ycyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBwYXJhIGVtaXNzw6NvIGRlIGVycm9zXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7SHR0cEVycm9yUmVzcG9uc2V9IGVycm9yXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIGhhbmRsZShlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpOiB2b2lkIHtcbiAgICAgICAgaWYgKGVycm9yLmVycm9yLnZpb2xhdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMudmlvbGF0aW9uKGVycm9yLnVybCwgZXJyb3IuZXJyb3IudmlvbGF0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVycm9yLmVycm9yLmZpZWxkRXJyb3JzKSB7XG4gICAgICAgICAgICB0aGlzLnZpb2xhdGlvbihlcnJvci51cmwsIGVycm9yLmVycm9yLmZpZWxkRXJyb3JzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gaXRlcmHDp8OjbyBkZSB2aW9sYcOnw7VlcyBlIGVtaXNzw6NvIGRlIGVycm9zXG4gICAgICogQHBhcmFtIHZhbHVlc1xuICAgICAqL1xuICAgIHZpb2xhdGlvbihmb3JtOiBzdHJpbmcsIHZhbHVlczogKHsgZmllbGQ6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nIH0pW10pIHtcbiAgICAgICAgdmFsdWVzLmZvckVhY2godmlvbGF0aW9uID0+XG4gICAgICAgICAgICB0aGlzLmZvcm1Ob3RpZmljYXRpb25TZXJ2aWNlLm5vdGlmeShcbiAgICAgICAgICAgICAgICBuZXcgRmllbGRGb3JtTm90aWZpY2F0aW9uKFxuICAgICAgICAgICAgICAgICAgICBmb3JtLCB2aW9sYXRpb24uZmllbGQsIHZpb2xhdGlvbi5tZXNzYWdlKSkpO1xuICAgIH1cblxufVxuIl19