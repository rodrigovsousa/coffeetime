import { __decorate } from "tslib";
import { Directive, Input, TemplateRef, ViewContainerRef, OnDestroy } from '@angular/core';
import { Authorization } from './authorization';
import { Authentication } from '../authentication';
/**
 * HasRoleDirective diretiva para checagem da existência de permissões de acesso para o usuário logado.
 * @class
 */
import * as ɵngcc0 from '@angular/core';
var HasRoleDirective = /** @class */ (function () {
    /**
     * Método construtor responsável por carregar o serviço de autorização e serviço de identificação de mudança
     * @param {TemplateRef<any>} templateRef
     * @param {ViewContainerRef} viewContainer
     * @param {Authorization} authorization
     * @param {Authentication<User>} authentication
     */
    function HasRoleDirective(templateRef, viewContainer, authorization, authentication) {
        this.templateRef = templateRef;
        this.viewContainer = viewContainer;
        this.authorization = authorization;
        this.authentication = authentication;
    }
    Object.defineProperty(HasRoleDirective.prototype, "hasRole", {
        /**
         * Propriedade para identificar regras de acesso aos itens
         * @type {string}
         */
        set: function (hasRole) {
            var _this = this;
            this.viewContainer.clear();
            if (hasRole) {
                if (this.loginNotifications)
                    this.loginNotifications.unsubscribe();
                this.loginNotifications = this.authentication.getLoginNotifications().subscribe(function () {
                    if (_this.authorization.hasRole(hasRole)) {
                        _this.viewContainer.clear();
                        _this.viewContainer.createEmbeddedView(_this.templateRef);
                    }
                });
            }
            else {
                this.viewContainer.createEmbeddedView(this.templateRef);
            }
        },
        enumerable: true,
        configurable: true
    });
    HasRoleDirective.prototype.ngOnDestroy = function () {
        this.loginNotifications.unsubscribe();
    };
    HasRoleDirective.ctorParameters = function () { return [
        { type: TemplateRef },
        { type: ViewContainerRef },
        { type: Authorization },
        { type: Authentication }
    ]; };
    __decorate([
        Input()
    ], HasRoleDirective.prototype, "hasRole", null);
HasRoleDirective.ɵfac = function HasRoleDirective_Factory(t) { return new (t || HasRoleDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ViewContainerRef), ɵngcc0.ɵɵdirectiveInject(Authorization), ɵngcc0.ɵɵdirectiveInject(Authentication)); };
HasRoleDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: HasRoleDirective, selectors: [["", "hasRole", ""]], inputs: { hasRole: "hasRole" } });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(HasRoleDirective, [{
        type: Directive,
        args: [{
                selector: '[hasRole]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }, { type: ɵngcc0.ViewContainerRef }, { type: Authorization }, { type: Authentication }]; }, { hasRole: [{
            type: Input
        }] }); })();
    return HasRoleDirective;
}());
export { HasRoleDirective };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFzLXJvbGUuZGlyZWN0aXZlLmpzIiwic291cmNlcyI6WyJuZzovQG51dmVtL2FuZ3VsYXItYmFzZS9saWIvc2VjdXJpdHkvYXV0aGVudGljYXRpb24vYXV0aG9yaXphdGlvbi9oYXMtcm9sZS5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxnQkFBZ0IsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0YsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUluRDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUlIO0FBQW9ELElBSWhEO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxJQUFJLDBCQUNZLFdBQTZCLEVBQzdCLGFBQStCLEVBQy9CLGFBQTRCLEVBQzVCLGNBQW9DO0FBQUksUUFIeEMsZ0JBQVcsR0FBWCxXQUFXLENBQWtCO0FBQUMsUUFDOUIsa0JBQWEsR0FBYixhQUFhLENBQWtCO0FBQUMsUUFDaEMsa0JBQWEsR0FBYixhQUFhLENBQWU7QUFBQyxRQUM3QixtQkFBYyxHQUFkLGNBQWMsQ0FBc0I7QUFBQyxJQUFHLENBQUM7QUFDekQsSUFLYSxzQkFBSSxxQ0FBTztBQUFJLFFBSnhCO0FBQ0o7QUFDSTtBQUVKLFdBRE87QUFDUCxhQUFhLFVBQVksT0FBMEI7QUFDbkQsWUFESSxpQkFhQztBQUNMLFlBYlEsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNuQyxZQUFRLElBQUksT0FBTyxFQUFFO0FBQ3JCLGdCQUFZLElBQUksSUFBSSxDQUFDLGtCQUFrQjtBQUFFLG9CQUFBLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUMvRSxnQkFBWSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLFNBQVMsQ0FBQztBQUN0RixvQkFBVSxJQUFJLEtBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFO0FBQ3pELHdCQUFvQixLQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQy9DLHdCQUFvQixLQUFJLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLEtBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUM1RSxxQkFBaUI7QUFDakIsZ0JBQVksQ0FBQyxDQUFDLENBQUM7QUFDZixhQUFTO0FBQUMsaUJBQUs7QUFDZixnQkFBWSxJQUFJLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUNwRSxhQUFTO0FBQ1QsUUFBSSxDQUFDO0FBRUw7QUFDeUI7QUFDQyxPQUpyQjtBQUNMLElBRUksc0NBQVcsR0FBWDtBQUFjLFFBQ1YsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxDQUFDO0FBQzlDLElBQUksQ0FBQztBQUVMO0FBQzJELGdCQTlCOUIsV0FBVztBQUFJLGdCQUNiLGdCQUFnQjtBQUM3QyxnQkFBNkIsYUFBYTtBQUMxQyxnQkFBOEIsY0FBYztBQUFHO0FBRWpELElBSWE7QUFBYSxRQUFyQixLQUFLLEVBQUU7QUFBQyxtREFhUjtJQWxDUSxnQkFBZ0Isd0JBSDVCLFNBQVMsQ0FBRSxjQUNSLFFBQVEsRUFBRSxXQUFXLFVBQ3hCLENBQUMsUUFDVyxnQkFBZ0IsQ0F5QzVCOzs7Ozs7Ozs7b0JBQ0Q7QUFBQyxJQURELHVCQUFDO0FBQ0EsQ0FEQSxBQXpDRCxJQXlDQztBQUNELFNBMUNhLGdCQUFnQjtBQUFJIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBJbnB1dCwgVGVtcGxhdGVSZWYsIFZpZXdDb250YWluZXJSZWYsIE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQXV0aG9yaXphdGlvbiB9IGZyb20gJy4vYXV0aG9yaXphdGlvbic7XG5pbXBvcnQgeyBBdXRoZW50aWNhdGlvbiB9IGZyb20gJy4uL2F1dGhlbnRpY2F0aW9uJztcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi91c2VyJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuXG4vKipcbiAqIEhhc1JvbGVEaXJlY3RpdmUgZGlyZXRpdmEgcGFyYSBjaGVjYWdlbSBkYSBleGlzdMOqbmNpYSBkZSBwZXJtaXNzw7VlcyBkZSBhY2Vzc28gcGFyYSBvIHVzdcOhcmlvIGxvZ2Fkby5cbiAqIEBjbGFzc1xuICovXG5ARGlyZWN0aXZlKCB7XG4gICAgc2VsZWN0b3I6ICdbaGFzUm9sZV0nXG59KVxuZXhwb3J0IGNsYXNzIEhhc1JvbGVEaXJlY3RpdmUgaW1wbGVtZW50cyBPbkRlc3Ryb3kge1xuXG4gICAgcHJpdmF0ZSBsb2dpbk5vdGlmaWNhdGlvbnM6IFN1YnNjcmlwdGlvbjtcblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gY29uc3RydXRvciByZXNwb25zw6F2ZWwgcG9yIGNhcnJlZ2FyIG8gc2VydmnDp28gZGUgYXV0b3JpemHDp8OjbyBlIHNlcnZpw6dvIGRlIGlkZW50aWZpY2HDp8OjbyBkZSBtdWRhbsOnYVxuICAgICAqIEBwYXJhbSB7VGVtcGxhdGVSZWY8YW55Pn0gdGVtcGxhdGVSZWZcbiAgICAgKiBAcGFyYW0ge1ZpZXdDb250YWluZXJSZWZ9IHZpZXdDb250YWluZXJcbiAgICAgKiBAcGFyYW0ge0F1dGhvcml6YXRpb259IGF1dGhvcml6YXRpb25cbiAgICAgKiBAcGFyYW0ge0F1dGhlbnRpY2F0aW9uPFVzZXI+fSBhdXRoZW50aWNhdGlvblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHRlbXBsYXRlUmVmOiBUZW1wbGF0ZVJlZjxhbnk+LFxuICAgICAgICBwcml2YXRlIHZpZXdDb250YWluZXI6IFZpZXdDb250YWluZXJSZWYsXG4gICAgICAgIHByaXZhdGUgYXV0aG9yaXphdGlvbjogQXV0aG9yaXphdGlvbixcbiAgICAgICAgcHJpdmF0ZSBhdXRoZW50aWNhdGlvbjogQXV0aGVudGljYXRpb248VXNlcj4pIHsgfVxuXG4gICAgLyoqXG4gICAgICogUHJvcHJpZWRhZGUgcGFyYSBpZGVudGlmaWNhciByZWdyYXMgZGUgYWNlc3NvIGFvcyBpdGVuc1xuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgQElucHV0KCkgc2V0IGhhc1JvbGUoaGFzUm9sZTogc3RyaW5nIHwgc3RyaW5nW10pIHtcbiAgICAgICAgdGhpcy52aWV3Q29udGFpbmVyLmNsZWFyKCk7XG4gICAgICAgIGlmIChoYXNSb2xlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5sb2dpbk5vdGlmaWNhdGlvbnMpIHRoaXMubG9naW5Ob3RpZmljYXRpb25zLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB0aGlzLmxvZ2luTm90aWZpY2F0aW9ucyA9IHRoaXMuYXV0aGVudGljYXRpb24uZ2V0TG9naW5Ob3RpZmljYXRpb25zKCkuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdXRob3JpemF0aW9uLmhhc1JvbGUoaGFzUm9sZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3Q29udGFpbmVyLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld0NvbnRhaW5lci5jcmVhdGVFbWJlZGRlZFZpZXcodGhpcy50ZW1wbGF0ZVJlZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdDb250YWluZXIuY3JlYXRlRW1iZWRkZWRWaWV3KHRoaXMudGVtcGxhdGVSZWYpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sb2dpbk5vdGlmaWNhdGlvbnMudW5zdWJzY3JpYmUoKTtcbiAgICB9XG5cbn1cbiJdfQ==