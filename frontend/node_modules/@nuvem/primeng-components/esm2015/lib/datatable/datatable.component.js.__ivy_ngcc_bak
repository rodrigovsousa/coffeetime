import { __decorate } from "tslib";
import { Component, ViewChild, Input, Output, ContentChildren, QueryList, ChangeDetectorRef, AfterViewInit, AfterContentInit, OnInit, EventEmitter, ViewEncapsulation, ElementRef, } from '@angular/core';
import { Table as DataTable } from 'primeng/table';
import { DataProviderFactory, DataProviderType } from './dataprovider-factory';
import { DatatableButtonComponent } from './datatable-button.component';
import { DatatableClickEvent } from './datatable-click-event';
import { Authorization, User } from '@nuvem/angular-base';
import { Column } from './p-column.directive';
/**
 * Class DatatableComponent
 * @class
 */
let DatatableComponent = class DatatableComponent {
    /**
     * constructor method
     * @constructor
     * @param {ChangeDetectorRef} changeDetectorRef
     * @param {DataProviderFactory} dataProviderFactory
     * @param {Authorization} authorizationService
     */
    constructor(changeDetectorRef, dataProviderFactory, authorizationService) {
        this.changeDetectorRef = changeDetectorRef;
        this.dataProviderFactory = dataProviderFactory;
        this.authorizationService = authorizationService;
        /**
         * filterParams property
         * @type {any}
         */
        this.filterParams = {};
        /**
         * footerMsg property
         * @type {string}
         */
        this.footerMsg = '';
        /**
         * orderInSort property
         * @type {boolean}
         */
        this.orderInSort = false;
        /**
         * value property
         * @type {any}
         */
        this.value = [];
        /**
         * type property
         * @type DataProviderType
         */
        this.type = DataProviderType.Server;
        /**
         * rows property
         * @type {number}
         */
        this.rows = 5;
        /**
         * showPaginationFooter property
         * @type {boolean}
         */
        this.showPaginationFooter = false;
        /**
         * disableEdit property
         * @type {boolean}
         */
        this.disableEdit = false;
        /**
         * disableView property
         * @type {boolean}
         */
        this.disableView = false;
        /**
         * disableDelete property
         * @type {boolean}
         */
        this.disableDelete = false;
        /**
         * selectionMode property
         * @type {string}
         */
        this.selectionMode = 'single';
        /**
         * enableButtonsScroll property
         * @type {boolean}
         */
        this.enableButtonsScroll = false;
        /**
         * emptyMessage property
         * @type {string}
         */
        this.emptyMessage = 'Nenhum registro encontrado.';
        /**
         * verticalButtons property
         * @type {boolean}
         */
        this.verticalButtons = true;
        /**
         * enableScroll property
         * @type {boolean}
         */
        this.enableScroll = false;
        /**
         * disableLoadingBlockUI property
         * @type {boolean}
         */
        this.disableLoadingBlockUI = false;
        /**
         * filterOnColumn property
         */
        this.filterOnColumn = false;
        /**
         * filterSelectOptions property
         */
        this.filterSelectOptions = [];
        /**
         * updateFiltroHistorico property
         */
        this.updateFilterColumn = false;
        /**
         * customFilterOptions property
         */
        this.customFilterOptions = {};
        /**
         * buttonClick property
         * @type {EventEmitter<any>}
         */
        this.buttonClick = new EventEmitter();
        /**
         * startedLoading property
         * @type {EventEmitter<void>}
         */
        this.startedLoading = new EventEmitter();
        /**
         * finishedLoading property
         * @type {EventEmitter<HttpErrorResponse>}
         */
        this.finishedLoading = new EventEmitter();
        /**
         * onRowSelected property
         * @type {EventEmitter<any>}
         */
        this.onRowSelected = new EventEmitter();
        /**
         * showHorizontalButtonsHeader property
         * @type {boolean}
         */
        this.showHorizontalButtonsHeader = false;
        /**
         * blockContent
         * @type {boolean}
         */
        this.blockContent = false;
        /**
         * visibleColumns property
         * @type {Object}
         */
        this.visibleColumns = {};
        /**
         * showVisibleColumnsControl property
         * @type {boolean}
         */
        this.showVisibleColumnsControl = false;
        /**
         * dataKey property
         * Identificador único para cada registro da tabela
         * @type {string}
         */
        this.dataKey = 'id';
        /**
         * onRowEditEvent property
         * Evento disparado quando o usuário realiza ações de edição em uma linha da tabela
         * @type {EventEmitter<void>}
         */
        this.onRowEditEvent = new EventEmitter();
        this.clonedRowData = {};
        /**
         * errorMessage property
         * @type {string}
         */
        this.errorMessage = 'Ocorreu um erro ao carregar os dados da tabela. Tente novamente.';
        this.editingRow = false;
    }
    /**
     * ngOnInit method
     * @returns void
     */
    ngOnInit() {
        this.dataProvider = this.dataProviderFactory.create(this.type, this);
        this.pDatatableComponent.rows = this.rows;
        this.subscribeToLoadingEvents();
        this.initRowsPerPageOptionsIfPresent();
        this.defineIfShouldShowHorizontalButtonsHeader();
        this.updateOnValueChange();
        this.finishedLoading.subscribe(() => {
            this.updateOnValueChange();
        });
    }
    /**
     * subscribeFromValueChange method
     * @returns void
     */
    updateOnValueChange() {
        this.filterSelectOptions = [];
        if (this.value) {
            this.value.map((item) => {
                this.filterSelectOptions.push(item);
            });
        }
    }
    /**
     * subscribeToLoadingEvents method
     * @returns void
     */
    subscribeToLoadingEvents() {
        if (!this.disableLoadingBlockUI) {
            this.originalEmptyMessage = this.emptyMessage;
            this.startedLoading.subscribe(() => this.onStartedLoading());
            this.finishedLoading.subscribe(error => this.onFinishedLoading(error));
        }
    }
    /**
     * onStartedLoading method
     * @returns void
     */
    onStartedLoading() {
        this.blockContent = true;
        this.emptyMessage = this.originalEmptyMessage;
    }
    /**
     * onFinishedLoading method
     * @param {HttpErrorResponse} error
     * @returns void
     */
    onFinishedLoading(error) {
        this.blockContent = false;
        if (error) {
            this.emptyMessage = this.errorMessage;
        }
    }
    /**
     * initRowsPerPageOptionsIfPresent method
     * @returns void
     */
    initRowsPerPageOptionsIfPresent() {
        if (this.rowsPerPageOptions) {
            this.pDatatableComponent.rowsPerPageOptions = this.rowsPerPageOptions;
        }
    }
    /**
     * defineIfShouldShowHorizontalButtonsHeader method
     * @returns void
     */
    defineIfShouldShowHorizontalButtonsHeader() {
        if (this.horizontalButtonsHeader) {
            this.showHorizontalButtonsHeader = true;
        }
    }
    /**
     * ngAfterViewInit method
     * @returns void
     */
    ngAfterViewInit() {
        this.setExtraParams();
        this.pDatatableComponent.columns = this.columns;
        this.pDatatableComponent.ngAfterContentInit();
        this.setAllColumnsVisible();
        this.changeDetectorRef.detectChanges();
    }
    /**
     * setExtraParams method
     * @returns void
     */
    setExtraParams() {
        for (let i in this.extraParams) {
            this.pDatatableComponent[i] = this.extraParams[i];
        }
    }
    /**
     * ngAfterContentInit method
     * @returns void
     */
    ngAfterContentInit() {
        this.extraButtons.forEach((button) => {
            button.click.subscribe(event => {
                this.onClick(button.name, event);
            });
        });
    }
    /**
     * onClick method
     * @param {string} button
     * @param {any} event
     * @return void
     */
    onClick(button, event) {
        this.buttonClick.emit(new DatatableClickEvent(button, this.selectedRow));
        event.stopPropagation();
        this.resetSelectedRow(button);
    }
    /**
     * onSelectChange method
     * @param {any} event
     * @returns void
     */
    onSelectChange(event) {
        this.onRowSelected.emit(this.selectedRow);
        if (Array.isArray(this.selectedRow) && this.selectedRow.length > 1) {
            this.updateMultipleButtonsStatus(true);
        }
        else {
            this.updateMultipleButtonsStatus(false);
        }
    }
    /**
     * updateMultipleButtonsStatus method
     * @param {boolean} hasMultipleSelection
     * @return void
     */
    updateMultipleButtonsStatus(hasMultipleSelection) {
        this.extraButtons.forEach((button) => {
            if (hasMultipleSelection && !button.allowMultipleSelection) {
                button.disabled = true;
            }
            else {
                button.disabled = false;
            }
        });
    }
    /**
     * refresh method
     * @param query
     * @returns void
     */
    refresh(query) {
        this.dataProvider.load(query);
    }
    /**
     * resetSelectedRow method
     * @param button
     * @returns void
     */
    resetSelectedRow(button) {
        if (button === 'delete') {
            this.selectedRow = null;
        }
    }
    /**
     * reset method
     * @returns void
     */
    reset() {
        this.pDatatableComponent.first = 0;
        this.dataProvider.reset();
        this.refresh();
    }
    /**
     * paginationFooterText method
     * @param {string} msg
     * @returns string
     */
    paginationFooterText(msg) {
        const registros = this.totalRecords() === 1 ? 'registro' : 'registros';
        if (msg === '') {
            return `Exibindo: ${this.currentFirstIndex()} a ${this.currentLastIndex()} de ${this.totalRecords()} ${registros}`;
        }
        msg = msg.replace('{totalRecords}', this.totalRecords().toString());
        msg = msg.replace('{currentFirstIndex}', this.currentFirstIndex().toString());
        msg = msg.replace('{currentLastIndex}', this.currentLastIndex().toString());
        return msg;
    }
    /**
     * currentFirstIndex method
     * @returns number
     */
    currentFirstIndex() {
        return this.pDatatableComponent.first + 1;
    }
    /**
     * currentLastIndex method
     * @returns number
     */
    currentLastIndex() {
        const currentLastIndex = this.pDatatableComponent.first + this.pDatatableComponent.rows;
        if (currentLastIndex > this.totalRecords()) {
            return this.totalRecords();
        }
        return currentLastIndex;
    }
    /**
     * totalRecords method
     * @returns number
     */
    totalRecords() {
        return this.pDatatableComponent.totalRecords;
    }
    /**
     * checkRolesToButton method
     * @param {string} button
     * @return boolean
     */
    checkRolesToButton(button) {
        if (this[button]) {
            if (button === 'rulesToHide' || button === 'rulesToShowEdit' || button === 'rulesToShowDelete') {
                this.checkUseButtons(button);
                return this.authorizationService.hasRole(this[button]);
            }
            return !this.authorizationService.hasRole(this[button]);
        }
        return true;
    }
    /**
     * checkUseButtons method
     * @param {string} button
     * @returns void
     */
    checkUseButtons(button) {
        if (this[button] && this[button.replace('Show', 'Hide')]) {
            throw new Error('Não é possível definir dois valores de roles para os botões padrões.');
        }
    }
    /**
     * filter method
     * @returns void
     */
    filter() {
        for (let prop in this.filterParams) {
            if (this.filterParams[prop] === '' || (this.filterParams[prop].length === 0)) {
                delete this.filterParams[prop];
            }
        }
        if (Object.getOwnPropertyNames(this.filterParams).length === 0) {
            this.reset();
        }
        else {
            this.refresh(this.filterParams);
        }
    }
    /**
     * Método para filtrar por colunas
     * @param column chave da coluna na tabela
     * @param filters valor do filtro
     */
    filterColumn(column, filters) {
        const values = [];
        if (filters instanceof Array) {
            values[column] = [];
            for (let item in filters) {
                let val = (filters[item] instanceof Object) ? filters[item].value : filters[item];
                values[column].push(val);
            }
        }
        else {
            values[column] = filters;
        }
        this.filterParams = Object.assign(Object.assign({}, this.filterParams), values);
        return this.filter();
    }
    /**
     * Inicia todas as colunas da tabela como visíveis
     */
    setAllColumnsVisible() {
        this.columns.forEach((col) => {
            this.visibleColumns[col.field] = 'table-cell';
        });
    }
    /**
     * Verifica se uma coluna deve estar visível
     * @param column string
     * @param visibleColumns Array
     */
    visibleColumnCheck(column, visibleColumns) {
        return visibleColumns.some((item) => {
            return (item.field) ? item.field == column : true;
        });
    }
    /**
     * Atualzia os valores da variável 'visibleColuns' para mostrar ou não as colunas
     * @param columns array
     */
    updateVisibleColumns(columns) {
        for (let col in this.visibleColumns) {
            if (this.visibleColumnCheck(col, columns)) {
                this.visibleColumns[col] = 'table-cell';
            }
            else {
                this.visibleColumns[col] = 'none';
            }
        }
    }
    onRowEditInitEvent(event, rowData) {
        const tr = event.srcElement.closest('tr');
        setTimeout(() => {
            this.editingRow = true;
            const top = tr.offsetTop;
            const height = tr.offsetHeight;
            const editButtons = tr.querySelector('.editar-campos');
            editButtons.style.top = (top + height - 75) + 'px';
            editButtons.style.height = '75px';
            editButtons.style.backgroundColor = '#d0d0d0';
            editButtons.style.opacity = 1;
            this.clonedRowData[rowData.id] = Object.assign({}, rowData);
            this.onRowEditEvent.emit({ event: "init", data: rowData });
        }, null, tr);
    }
    onRowEditSaveEvent(event, rowData) {
        this.onRowEditEvent.emit({ event: "save", data: rowData });
        this.resetEditingMode(event);
    }
    onRowEditCancelEvent(event, rowData, index) {
        this.value[index] = this.clonedRowData[rowData.id];
        delete this.clonedRowData[rowData[this.dataKey]];
        this.onRowEditEvent.emit({ event: "cancel", data: rowData });
        this.resetEditingMode(event);
    }
    resetEditingMode(event) {
        const editButtons = event.srcElement.closest('tr').querySelector('.editar-campos');
        editButtons.style.opacity = 0;
        editButtons.style.backgroundColor = '#0000006b';
        editButtons.style.display = 'none';
        this.editingRow = false;
    }
    editarLinhaOver(event) {
        if (!this.editingRow && this.editMode == 'row') {
            const top = event.srcElement.closest('tr').offsetTop;
            const height = event.srcElement.closest('tr').offsetHeight;
            const editButtons = event.srcElement.closest('tr').querySelector('.editar-campos');
            editButtons.style.display = 'flex';
            editButtons.style.top = top + 'px';
            editButtons.style.height = height + 'px';
            editButtons.style.backgroundColor = '#0000006b';
            editButtons.style.opacity = 1;
        }
    }
    editarLinhaOut(event) {
        if (!this.editingRow) {
            const editButtons = event.srcElement.closest('tr').querySelector('.editar-campos');
            editButtons.style.display = 'none';
            editButtons.style.opacity = 0;
        }
    }
};
DatatableComponent.ctorParameters = () => [
    { type: ChangeDetectorRef },
    { type: DataProviderFactory },
    { type: Authorization }
];
__decorate([
    Input()
], DatatableComponent.prototype, "splitButton", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "value", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "type", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rows", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rowsPerPageOptions", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "url", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "extraParams", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "paginationParameters", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "showPaginationFooter", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "disableEdit", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "disableView", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "disableDelete", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "selectionMode", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "enableButtonsScroll", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "emptyMessage", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "verticalButtons", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "enableScroll", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "scrollHeight", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "scrollWidth", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rulesToHide", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rulesToShowEdit", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rulesToShowDelete", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rulesToHideView", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rulesToHideEdit", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rulesToHideDelete", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "disableLoadingBlockUI", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "rowStyleClass", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "filterOnColumn", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "customFilterOptions", void 0);
__decorate([
    Output()
], DatatableComponent.prototype, "buttonClick", void 0);
__decorate([
    ViewChild(DataTable, { static: true })
], DatatableComponent.prototype, "pDatatableComponent", void 0);
__decorate([
    ContentChildren(DatatableButtonComponent)
], DatatableComponent.prototype, "extraButtons", void 0);
__decorate([
    ContentChildren(Column)
], DatatableComponent.prototype, "columns", void 0);
__decorate([
    Output()
], DatatableComponent.prototype, "startedLoading", void 0);
__decorate([
    Output()
], DatatableComponent.prototype, "finishedLoading", void 0);
__decorate([
    Output()
], DatatableComponent.prototype, "onRowSelected", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "showVisibleColumnsControl", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "editMode", void 0);
__decorate([
    Input()
], DatatableComponent.prototype, "dataKey", void 0);
__decorate([
    Output()
], DatatableComponent.prototype, "onRowEditEvent", void 0);
DatatableComponent = __decorate([
    Component({
        selector: 'basis-datatable',
        template: "<p-blockUI [blocked]=\"blockContent\">\n    <div class=\"center-spinner\">\n        <p-progressSpinner></p-progressSpinner>\n    </div>\n</p-blockUI>\n<div [ngClass]=\"{'ui-g-2':verticalButtons, 'ui-g-5':!verticalButtons}\">&nbsp;</div>\n<div [ngClass]=\"verticalButtons ? 'ui-g-11' : 'ui-g-12'\">\n    <basis-show-column *ngIf=\"showVisibleColumnsControl\" [columns]=\"columns\" (updateVisibleColumns)=\"updateVisibleColumns($event)\"></basis-show-column>\n</div>\n<div [ngClass]=\"{\n        'ui-g-11' : verticalButtons,\n        'ui-g-12' : !verticalButtons,\n        'edicao-tabela' : editMode == 'row',\n        'editing-row': editingRow\n    }\">\n    <p-table\n        [value]=\"value\"\n        [rows]=\"rows\"\n        [paginator]=\"true\"\n        [selectionMode]=\"selectionMode\"\n        [responsive]=\"true\"\n        [scrollable]=\"enableScroll\"\n        [scrollHeight]=\"scrollHeight\"\n        [(selection)]=\"selectedRow\"\n        [editMode]=\"editMode\"\n        (onRowSelect)=\"onSelectChange($event)\"\n        (onRowUnselect)=\"onSelectChange($event)\"\n        #datatable\n        [dataKey]=\"dataKey\">\n        <ng-template pTemplate=\"header\" let-columns>\n            <div class=\"ui-g\" *ngIf=\"!verticalButtons\">\n                <div *ngIf=\"showHorizontalButtonsHeader\" class=\"ui-g-4 ui-sm-12\">\n                    <span class=\"horizontal-buttons-header\">{{ horizontalButtonsHeader }}</span>\n                </div>\n                <div [ngClass]=\"{\n                    'horizontal-buttons': true,\n                    'ui-sm-12': true,\n                    'ui-g-8': showHorizontalButtonsHeader,\n                    'ui-g-12': !showHorizontalButtonsHeader}\">\n                    <ng-container *ngTemplateOutlet=\"defaultButtons\"></ng-container>\n                    <ng-content select=\"horizontalButtons\"></ng-content>\n                </div>\n            </div>\n            <tr>\n                <th *ngFor=\"let col of columns\"\n                    [pSortableColumn]=\"col.sortable ? col.field : null\"\n                    [ngStyle]=\"{'display': visibleColumns[col.field]}\">\n                    {{col.header}}\n                    <p-sortIcon *ngIf=\"col.sortable\" [field]=\"col.field\"></p-sortIcon>\n                </th>\n            </tr>\n            <tr *ngIf=\"filterOnColumn\">\n                <th *ngFor=\"let col of columns\" [ngStyle]=\"{'display': visibleColumns[col.field]}\">\n                    <basis-filter-column\n                        [listaOriginal]=\"filterSelectOptions\"\n                        [lista]=\"filterSelectOptions\"\n                        [field]=\"col.field\"\n                        [updateFiltro]=\"updateFilterColumn\"\n                        (outputEvent)=\"filterColumn(col.field, $event)\"\n                        [filterType]=\"col.filterType\"\n                        [tableType]=\"type\"\n                        [customFilterOptions]=\"customFilterOptions\">\n                    </basis-filter-column>\n                </th>\n            </tr>\n        </ng-template>\n        <ng-template pTemplate=\"body\" let-rowData let-columns=\"columns\" let-editing=\"editing\" let-ri=\"rowIndex\">\n            <tr [pSelectableRow]=\"rowData\"\n                [pContextMenuRow]=\"rowData\"\n                [pEditableRow]=\"rowData\"\n                [ngClass]=\"{'editing': editing}\"\n                (mouseover)=\"editarLinhaOver($event)\"\n                (mouseleave)=\"editarLinhaOut($event)\">\n                <td *ngFor=\"let col of columns; last as isLast\" [ngStyle]=\"{'display': visibleColumns[col.field]}\" >\n                    <ng-container *ngIf=\"!editMode\">\n                        <span *ngIf=\"!col.bodyTemplate\" [innerHTML]=\"rowData[col.field]\"></span>\n                        <ng-container\n                            *ngIf=\"col.bodyTemplate\"\n                            [ngTemplateOutlet]=\"col.bodyTemplate\"\n                            [ngTemplateOutletContext]=\"{ rowData: rowData, col: col }\">\n                        </ng-container>\n                    </ng-container>\n\n                    <ng-container *ngIf=\"editMode\">\n                        <p-cellEditor>\n                            <ng-template pTemplate=\"input\">\n                                <span *ngIf=\"!col.outputTemplate && col.editable == false\" [innerHTML]=\"rowData[col.field]\"></span>\n                                <div class=\"ui-md-12\" *ngIf=\"!col.inputTemplate && col.editable != false\">\n                                    <div class=\"ui-g form-group\">\n                                        <div class=\"ui-md-12\">\n                                            <span class=\"md-inputfield\">\n                                                <input pInputText type=\"text\" [(ngModel)]=\"rowData[col.field]\" [style]=\"{'width':'100%'}\">\n                                                <label>{{ col.header }}</label>\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                                <ng-container\n                                    *ngIf=\"col.inputTemplate\"\n                                    [ngTemplateOutlet]=\"col.inputTemplate\"\n                                    [ngTemplateOutletContext]=\"{ 'rowData': rowData, 'col': col }\">\n                                </ng-container>\n                            </ng-template>\n                            <ng-template pTemplate=\"output\">\n                                <span *ngIf=\"!col.outputTemplate\" [innerHTML]=\"rowData[col.field]\"></span>\n                                <ng-container\n                                    *ngIf=\"col.outputTemplate\"\n                                    [ngTemplateOutlet]=\"col.outputTemplate\"\n                                    [ngTemplateOutletContext]=\"{ rowData: rowData, col: col }\">\n                                </ng-container>\n                            </ng-template>\n                        </p-cellEditor>\n                    </ng-container>\n                    <div *ngIf=\"isLast\" class=\"editar-campos\">\n                        <button *ngIf=\"!editing\" pButton type=\"button\" pInitEditableRow (click)=\"onRowEditInitEvent($event, rowData)\">Editar</button>\n                        <button *ngIf=\"editing\" pButton type=\"button\" pSaveEditableRow class=\"ui-button-success\" style=\"margin-right: .5em\" (click)=\"onRowEditSaveEvent($event, rowData)\">Salvar</button>\n                        <button *ngIf=\"editing\" pButton type=\"button\" pCancelEditableRow class=\"ui-button-danger\" (click)=\"onRowEditCancelEvent($event, rowData, ri)\">Cancelar</button>\n                    </div>\n                </td>\n            </tr>\n        </ng-template>\n        <ng-template *ngIf=\"emptyMessage\">\n            {{ emptyMessage }}\n        </ng-template>\n        <p-footer *ngIf=\"showPaginationFooter && totalRecords() > 0\">\n            {{ paginationFooterText(footerMsg) }}\n        </p-footer>\n\n    </p-table>\n</div>\n<div *ngIf=\"verticalButtons\"\n    class=\"ui-g-1 ui-g-nopad\"\n    [style.position]=\"enableButtonsScroll ? 'sticky' : ''\"\n    [style.top]=\"enableButtonsScroll ? '15%' : ''\">\n        <ng-container *ngTemplateOutlet=\"defaultButtons\"></ng-container>\n        <ng-content></ng-content>\n</div>\n\n<ng-template #defaultButtons>\n    <basis-datatable-button [bTooltip]=\"selectedRow != null ? 'Editar' : 'Escolha um registro para editar.' \"\n        [class.horizontal-button]=\"!verticalButtons\" class=\"ui-button-success\" icon=\"edit\" (click)=\"onClick('edit', $event)\"\n        *ngIf=\"!disableEdit && checkRolesToButton('rulesToShowView') && checkRolesToButton('rulesToHideView')\" [disabled]=\"selectedRow == null\">\n    </basis-datatable-button>\n\n    <basis-datatable-button [bTooltip]=\"selectedRow != null ? 'Visualizar' : 'Escolha um registro para visualizar.'\"\n        [class.horizontal-button]=\"!verticalButtons\" icon=\"remove-red-eye\" (click)=\"onClick('view', $event)\"\n        *ngIf=\"!disableView && checkRolesToButton('rulesToShowEdit') && checkRolesToButton('rulesToHideEdit')\" [disabled]=\"selectedRow == null\">\n    </basis-datatable-button>\n\n    <basis-datatable-button [bTooltip]=\"selectedRow != null ? 'Excluir' : 'Escolha um registro para excluir.'\"\n        [class.horizontal-button]=\"!verticalButtons\" class=\"ui-button-danger\" icon=\"delete\" (click)=\"onClick('delete', $event)\"\n       *ngIf=\"!disableDelete && checkRolesToButton('rulesToShowDelete') && checkRolesToButton('rulesToHideDelete')\" [disabled]=\"selectedRow == null\">\n    </basis-datatable-button>\n\n    <datatable-splitbutton\n        [icon]=\"splitButton.icon\"\n        [class]=\"splitButton.class\"\n        [items]=\"splitButton.itens\"\n        [label]=\"splitButton.label\"\n        [method]=\"splitButton.method\"\n        *ngIf=\"splitButton\">\n    </datatable-splitbutton>\n</ng-template>\n",
        encapsulation: ViewEncapsulation.None,
        styles: ["body .ui-datatable .ui-datatable-data tr td{word-wrap:break-word}.horizontal-buttons{display:flex;flex-flow:row wrap;justify-content:flex-end}.horizontal-button{padding:0 3px}.horizontal-buttons-header{font-size:1.3em;word-wrap:break-word}.center-spinner{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;min-height:100vh}.text-right{text-align:right}basis-show-column .ui-multiselect-panel.ui-widget{width:100%;max-width:100%}.edicao-tabela,.edita-linha{position:relative}tr.editing td{padding-bottom:75px!important}.editar-campos{opacity:0;position:absolute;width:100%;background-color:#0000006b;left:0;margin-top:0;display:flex;align-items:center;justify-content:center;min-height:35px;transition:.3s ease-in-out;z-index:1}.editar-campos button{color:#fff;font-size:14px;padding:6px 30px 10px;border-radius:5px;height:28px;width:120px!important}.bt-cancelar,.bt-salvar{margin:0 10px}"]
    })
], DatatableComponent);
export { DatatableComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YXRhYmxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BudXZlbS9wcmltZW5nLWNvbXBvbmVudHMvIiwic291cmNlcyI6WyJsaWIvZGF0YXRhYmxlL2RhdGF0YWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQ1QsU0FBUyxFQUNULEtBQUssRUFDTCxNQUFNLEVBQ04sZUFBZSxFQUNmLFNBQVMsRUFDVCxpQkFBaUIsRUFDakIsYUFBYSxFQUNiLGdCQUFnQixFQUNoQixNQUFNLEVBQ04sWUFBWSxFQUNaLGlCQUFpQixFQUNqQixVQUFVLEdBQ2IsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLEtBQUssSUFBSSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFbkQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLGdCQUFnQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDL0UsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDeEUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFHOUQsT0FBTyxFQUFFLGFBQWEsRUFBRSxJQUFJLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFOUM7OztHQUdHO0FBT0gsSUFBYSxrQkFBa0IsR0FBL0IsTUFBYSxrQkFBa0I7SUFrVTNCOzs7Ozs7T0FNRztJQUNILFlBQ1ksaUJBQW9DLEVBQ3BDLG1CQUF3QyxFQUN4QyxvQkFBbUM7UUFGbkMsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFtQjtRQUNwQyx3QkFBbUIsR0FBbkIsbUJBQW1CLENBQXFCO1FBQ3hDLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBZTtRQTlUL0M7OztXQUdHO1FBQ0gsaUJBQVksR0FBUSxFQUFFLENBQUM7UUFFdkI7OztXQUdHO1FBQ0gsY0FBUyxHQUFX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QVIsS0FBSyxFQUFFOzJEQUFzQjtBQU1yQjtJQUFSLEtBQUssRUFBRTs2REFBd0I7QUFNdkI7SUFBUixLQUFLLEVBQUU7MkRBQXNCO0FBTXJCO0lBQVIsS0FBSyxFQUFFOzJEQUFzQjtBQU1yQjtJQUFSLEtBQUssRUFBRTs2REFBd0I7QUFZdkI7SUFBUixLQUFLLEVBQUU7aUVBQStCO0FBTTlCO0lBQVIsS0FBSyxFQUFFO3lEQUFvQjtBQUtuQjtJQUFSLEtBQUssRUFBRTswREFBd0I7QUFldkI7SUFBUixLQUFLLEVBQUU7K0RBQWlDO0FBTS9CO0lBQVQsTUFBTSxFQUFFO3VEQUEwRDtBQU0zQjtJQUF2QyxTQUFTLENBQUMsU0FBUyxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxDQUFDOytEQUFnQztBQU01QjtJQUExQyxlQUFlLENBQUMsd0JBQXdCLENBQUM7d0RBQW1EO0FBTXBFO0lBQXhCLGVBQWUsQ0FBQyxNQUFNLENBQUM7bURBQW1CO0FBTWpDO0lBQVQsTUFBTSxFQUFFOzBEQUErRDtBQU05RDtJQUFULE1BQU0sRUFBRTsyREFBMEY7QUFNekY7SUFBVCxNQUFNLEVBQUU7eURBQTREO0FBd0I1RDtJQUFSLEtBQUssRUFBRTtxRUFBNEM7QUFNM0M7SUFBUixLQUFLLEVBQUU7b0RBQWtCO0FBT2pCO0lBQVIsS0FBSyxFQUFFO21EQUF3QjtBQU90QjtJQUFULE1BQU0sRUFBRTswREFBNkQ7QUFoVDdELGtCQUFrQjtJQU45QixTQUFTLENBQUM7UUFDUCxRQUFRLEVBQUUsaUJBQWlCO1FBQzNCLDA1UkFBeUM7UUFFekMsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUk7O0tBQ3hDLENBQUM7R0FDVyxrQkFBa0IsQ0E0dEI5QjtTQTV0Qlksa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBDb21wb25lbnQsXG4gICAgVmlld0NoaWxkLFxuICAgIElucHV0LFxuICAgIE91dHB1dCxcbiAgICBDb250ZW50Q2hpbGRyZW4sXG4gICAgUXVlcnlMaXN0LFxuICAgIENoYW5nZURldGVjdG9yUmVmLFxuICAgIEFmdGVyVmlld0luaXQsXG4gICAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgICBPbkluaXQsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIFZpZXdFbmNhcHN1bGF0aW9uLFxuICAgIEVsZW1lbnRSZWYsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVGFibGUgYXMgRGF0YVRhYmxlIH0gZnJvbSAncHJpbWVuZy90YWJsZSc7XG5pbXBvcnQgeyBEYXRhUHJvdmlkZXIgfSBmcm9tICcuL2RhdGFwcm92aWRlcic7XG5pbXBvcnQgeyBEYXRhUHJvdmlkZXJGYWN0b3J5LCBEYXRhUHJvdmlkZXJUeXBlIH0gZnJvbSAnLi9kYXRhcHJvdmlkZXItZmFjdG9yeSc7XG5pbXBvcnQgeyBEYXRhdGFibGVCdXR0b25Db21wb25lbnQgfSBmcm9tICcuL2RhdGF0YWJsZS1idXR0b24uY29tcG9uZW50JztcbmltcG9ydCB7IERhdGF0YWJsZUNsaWNrRXZlbnQgfSBmcm9tICcuL2RhdGF0YWJsZS1jbGljay1ldmVudCc7XG5pbXBvcnQgeyBEYXRhdGFibGVQYWdpbmF0aW9uUGFyYW1ldGVycyB9IGZyb20gJy4vZGF0YXRhYmxlLXBhZ2luYXRpb24tcGFyYW1ldGVycyc7XG5pbXBvcnQgeyBIdHRwRXJyb3JSZXNwb25zZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IEF1dGhvcml6YXRpb24sIFVzZXIgfSBmcm9tICdAbnV2ZW0vYW5ndWxhci1iYXNlJztcbmltcG9ydCB7IENvbHVtbiB9IGZyb20gJy4vcC1jb2x1bW4uZGlyZWN0aXZlJztcblxuLyoqXG4gKiBDbGFzcyBEYXRhdGFibGVDb21wb25lbnRcbiAqIEBjbGFzc1xuICovXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2Jhc2lzLWRhdGF0YWJsZScsXG4gICAgdGVtcGxhdGVVcmw6ICcuL2RhdGF0YWJsZS5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vZGF0YXRhYmxlLmNvbXBvbmVudC5jc3MnXSxcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXG59KVxuZXhwb3J0IGNsYXNzIERhdGF0YWJsZUNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIEFmdGVyQ29udGVudEluaXQsIE9uSW5pdCB7XG5cbiAgICAvKipcbiAgICAgKiBzZWxlY3RlZFJvdyBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHthbnl9XG4gICAgICovXG4gICAgc2VsZWN0ZWRSb3c6IGFueTtcblxuICAgIC8qKlxuICAgICAqIGRhdGFQcm92aWRlciBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHtEYXRhUHJvdmlkZXJ9XG4gICAgICovXG4gICAgZGF0YVByb3ZpZGVyOiBEYXRhUHJvdmlkZXI7XG5cbiAgICAvKipcbiAgICAgKiBmaWx0ZXJQYXJhbXMgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7YW55fVxuICAgICAqL1xuICAgIGZpbHRlclBhcmFtczogYW55ID0ge307XG5cbiAgICAvKipcbiAgICAgKiBmb290ZXJNc2cgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGZvb3Rlck1zZzogc3RyaW5nID0gJyc7XG5cbiAgICAvKipcbiAgICAgKiBvcmRlckluU29ydCBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIG9yZGVySW5Tb3J0OiBib29sZWFuID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBzcGxpdEJ1dHRvbiBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHthbnl9XG4gICAgICovXG4gICAgQElucHV0KCkgc3BsaXRCdXR0b246IGFueTtcblxuICAgIC8qKlxuICAgICAqIHZhbHVlIHByb3BlcnR5XG4gICAgICogQHR5cGUge2FueX1cbiAgICAgKi9cbiAgICBASW5wdXQoKSB2YWx1ZTogYW55W10gPSBbXTtcblxuICAgIC8qKlxuICAgICAqIHR5cGUgcHJvcGVydHlcbiAgICAgKiBAdHlwZSBEYXRhUHJvdmlkZXJUeXBlXG4gICAgICovXG4gICAgQElucHV0KCkgdHlwZTogRGF0YVByb3ZpZGVyVHlwZSA9IERhdGFQcm92aWRlclR5cGUuU2VydmVyO1xuXG4gICAgLyoqXG4gICAgICogcm93cyBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgQElucHV0KCkgcm93czogbnVtYmVyID0gNTtcblxuICAgIC8qKlxuICAgICAqIHJvd3NQZXJQYWdlT3B0aW9ucyBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHtudW1iZXJbXX1cbiAgICAgKi9cbiAgICBASW5wdXQoKSByb3dzUGVyUGFnZU9wdGlvbnM6IG51bWJlcltdO1xuXG4gICAgLyoqXG4gICAgICogdXJsIHByb3BlcnR5XG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICBASW5wdXQoKSB1cmw6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIGV4dHJhUGFyYW1zIHByb3BlcnR5XG4gICAgICogQHR5cGUge2FueX1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBleHRyYVBhcmFtczogYW55O1xuXG4gICAgLyoqXG4gICAgICogcGFnaW5hdGlvblBhcmFtZXRlcnMgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7RGF0YXRhYmxlUGFnaW5hdGlvblBhcmFtZXRlcnN9XG4gICAgICovXG4gICAgQElucHV0KCkgcGFnaW5hdGlvblBhcmFtZXRlcnM6IERhdGF0YWJsZVBhZ2luYXRpb25QYXJhbWV0ZXJzO1xuXG4gICAgLyoqXG4gICAgICogc2hvd1BhZ2luYXRpb25Gb290ZXIgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBzaG93UGFnaW5hdGlvbkZvb3RlciA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogZGlzYWJsZUVkaXQgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBkaXNhYmxlRWRpdCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogZGlzYWJsZVZpZXcgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBkaXNhYmxlVmlldyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogZGlzYWJsZURlbGV0ZSBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIEBJbnB1dCgpIGRpc2FibGVEZWxldGUgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIHNlbGVjdGlvbk1vZGUgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIEBJbnB1dCgpIHNlbGVjdGlvbk1vZGUgPSAnc2luZ2xlJztcblxuICAgIC8qKlxuICAgICAqIGVuYWJsZUJ1dHRvbnNTY3JvbGwgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBlbmFibGVCdXR0b25zU2Nyb2xsID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBlbXB0eU1lc3NhZ2UgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIEBJbnB1dCgpIGVtcHR5TWVzc2FnZSA9ICdOZW5odW0gcmVnaXN0cm8gZW5jb250cmFkby4nO1xuXG4gICAgLyoqXG4gICAgICogdmVydGljYWxCdXR0b25zIHByb3BlcnR5XG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgQElucHV0KCkgdmVydGljYWxCdXR0b25zID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIGVuYWJsZVNjcm9sbCBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIEBJbnB1dCgpIGVuYWJsZVNjcm9sbCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogc2Nyb2xsSGVpZ2h0IHByb3BlcnR5XG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICBASW5wdXQoKSBzY3JvbGxIZWlnaHQ6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIHNjcm9sbFdpZHRoIHByb3BlcnR5XG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICBASW5wdXQoKSBzY3JvbGxXaWR0aDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogcnVsZXNUb0hpZGUgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7YW55fVxuICAgICAqL1xuICAgIEBJbnB1dCgpIHJ1bGVzVG9IaWRlOiBhbnk7XG5cbiAgICAvKipcbiAgICAgKiBydWxlc1RvU2hvd0VkaXQgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7YW55fVxuICAgICAqL1xuICAgIEBJbnB1dCgpIHJ1bGVzVG9TaG93RWRpdDogYW55O1xuXG4gICAgLyoqXG4gICAgICogcnVsZXNUb1Nob3dEZWxldGUgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7YW55fVxuICAgICAqL1xuICAgIEBJbnB1dCgpIHJ1bGVzVG9TaG93RGVsZXRlOiBhbnk7XG5cbiAgICAvKipcbiAgICAgKiBydWxlc1RvSGlkZVZpZXcgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7YW55fVxuICAgICAqL1xuICAgIEBJbnB1dCgpIHJ1bGVzVG9IaWRlVmlldzogYW55O1xuXG4gICAgLyoqXG4gICAgICogcnVsZXNUb0hpZGVFZGl0IHByb3BlcnR5XG4gICAgICogQHR5cGUge2FueX1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBydWxlc1RvSGlkZUVkaXQ6IGFueTtcblxuICAgIC8qKlxuICAgICAqIHJ1bGVzVG9IaWRlRGVsZXRlIHByb3BlcnR5XG4gICAgICogQHR5cGUge2FueX1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBydWxlc1RvSGlkZURlbGV0ZTogYW55O1xuXG4gICAgLyoqXG4gICAgICogaG9yaXpvbnRhbEJ1dHRvbnNIZWFkZXIgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGhvcml6b250YWxCdXR0b25zSGVhZGVyOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBkaXNhYmxlTG9hZGluZ0Jsb2NrVUkgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASW5wdXQoKSBkaXNhYmxlTG9hZGluZ0Jsb2NrVUkgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIHJvd1N0eWxlQ2xhc3MgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7YW55fVxuICAgICAqL1xuICAgIEBJbnB1dCgpIHJvd1N0eWxlQ2xhc3M6IGFueTtcblxuICAgIC8qKlxuICAgICAqIGZpbHRlck9uQ29sdW1uIHByb3BlcnR5XG4gICAgICovXG4gICAgQElucHV0KCkgZmlsdGVyT25Db2x1bW4gPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIGZpbHRlclNlbGVjdE9wdGlvbnMgcHJvcGVydHlcbiAgICAgKi9cbiAgICBmaWx0ZXJTZWxlY3RPcHRpb25zOiBhbnlbXSA9IFtdO1xuXG4gICAgLyoqXG4gICAgICogdXBkYXRlRmlsdHJvSGlzdG9yaWNvIHByb3BlcnR5XG4gICAgICovXG4gICAgdXBkYXRlRmlsdGVyQ29sdW1uOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBjdXN0b21GaWx0ZXJPcHRpb25zIHByb3BlcnR5XG4gICAgICovXG4gICAgQElucHV0KCkgY3VzdG9tRmlsdGVyT3B0aW9uczogT2JqZWN0ID0ge31cblxuICAgIC8qKlxuICAgICAqIGJ1dHRvbkNsaWNrIHByb3BlcnR5XG4gICAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxhbnk+fVxuICAgICAqL1xuICAgIEBPdXRwdXQoKSBidXR0b25DbGljazogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAgIC8qKlxuICAgICAqIHBEYXRhdGFibGVDb21wb25lbnQgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7VGFibGV9XG4gICAgICovXG4gICAgQFZpZXdDaGlsZChEYXRhVGFibGUsIHsgc3RhdGljOiB0cnVlIH0pIHBEYXRhdGFibGVDb21wb25lbnQ6IERhdGFUYWJsZTtcblxuICAgIC8qKlxuICAgICAqIGV4dHJhQnV0dG9ucyBwcm9wZXJ0eVxuICAgICAqIEB0eXBlIHtRdWVyeUxpc3Q8RGF0YXRhYmxlQnV0dG9uQ29tcG9uZW50Pn1cbiAgICAgKi9cbiAgICBAQ29udGVudENoaWxkcmVuKERhdGF0YWJsZUJ1dHRvbkNvbXBvbmVudCkgZXh0cmFCdXR0b25zOiBRdWVyeUxpc3Q8RGF0YXRhYmxlQnV0dG9uQ29tcG9uZW50PjtcblxuICAgIC8qKlxuICAgICAqIGNvbHVtbnMgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7YW55W119XG4gICAgICovXG4gICAgQENvbnRlbnRDaGlsZHJlbihDb2x1bW4pIGNvbHVtbnM6IENvbHVtbltdO1xuXG4gICAgLyoqXG4gICAgICogc3RhcnRlZExvYWRpbmcgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7RXZlbnRFbWl0dGVyPHZvaWQ+fVxuICAgICAqL1xuICAgIEBPdXRwdXQoKSBzdGFydGVkTG9hZGluZzogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gICAgLyoqXG4gICAgICogZmluaXNoZWRMb2FkaW5nIHByb3BlcnR5XG4gICAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxIdHRwRXJyb3JSZXNwb25zZT59XG4gICAgICovXG4gICAgQE91dHB1dCgpIGZpbmlzaGVkTG9hZGluZzogRXZlbnRFbWl0dGVyPEh0dHBFcnJvclJlc3BvbnNlPiA9IG5ldyBFdmVudEVtaXR0ZXI8SHR0cEVycm9yUmVzcG9uc2U+KCk7XG5cbiAgICAvKipcbiAgICAgKiBvblJvd1NlbGVjdGVkIHByb3BlcnR5XG4gICAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxhbnk+fVxuICAgICAqL1xuICAgIEBPdXRwdXQoKSBvblJvd1NlbGVjdGVkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgLyoqXG4gICAgICogc2hvd0hvcml6b250YWxCdXR0b25zSGVhZGVyIHByb3BlcnR5XG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgc2hvd0hvcml6b250YWxCdXR0b25zSGVhZGVyID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBibG9ja0NvbnRlbnRcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBibG9ja0NvbnRlbnQgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIHZpc2libGVDb2x1bW5zIHByb3BlcnR5XG4gICAgICogQHR5cGUge09iamVjdH1cbiAgICAgKi9cbiAgICB2aXNpYmxlQ29sdW1uczogT2JqZWN0ID0ge307XG5cbiAgICAvKipcbiAgICAgKiBzaG93VmlzaWJsZUNvbHVtbnNDb250cm9sIHByb3BlcnR5XG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgQElucHV0KCkgc2hvd1Zpc2libGVDb2x1bW5zQ29udHJvbDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogZWRpdE1vZGUgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIEBJbnB1dCgpIGVkaXRNb2RlOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBkYXRhS2V5IHByb3BlcnR5XG4gICAgICogSWRlbnRpZmljYWRvciDDum5pY28gcGFyYSBjYWRhIHJlZ2lzdHJvIGRhIHRhYmVsYVxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgQElucHV0KCkgZGF0YUtleTogc3RyaW5nID0gJ2lkJztcblxuICAgIC8qKlxuICAgICAqIG9uUm93RWRpdEV2ZW50IHByb3BlcnR5XG4gICAgICogRXZlbnRvIGRpc3BhcmFkbyBxdWFuZG8gbyB1c3XDoXJpbyByZWFsaXphIGHDp8O1ZXMgZGUgZWRpw6fDo28gZW0gdW1hIGxpbmhhIGRhIHRhYmVsYVxuICAgICAqIEB0eXBlIHtFdmVudEVtaXR0ZXI8dm9pZD59XG4gICAgICovXG4gICAgQE91dHB1dCgpIG9uUm93RWRpdEV2ZW50OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgY2xvbmVkUm93RGF0YTogeyBbczogc3RyaW5nXTogYW55OyB9ID0ge307XG5cbiAgICAvKipcbiAgICAgKiBlcnJvck1lc3NhZ2UgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHByaXZhdGUgZXJyb3JNZXNzYWdlID0gJ09jb3JyZXUgdW0gZXJybyBhbyBjYXJyZWdhciBvcyBkYWRvcyBkYSB0YWJlbGEuIFRlbnRlIG5vdmFtZW50ZS4nO1xuXG4gICAgLyoqXG4gICAgICogb3JpZ2luYWxFbXB0eU1lc3NhZ2UgcHJvcGVydHlcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHByaXZhdGUgb3JpZ2luYWxFbXB0eU1lc3NhZ2U6IHN0cmluZztcblxuICAgIGVkaXRpbmdSb3cgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIGNvbnN0cnVjdG9yIG1ldGhvZFxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7Q2hhbmdlRGV0ZWN0b3JSZWZ9IGNoYW5nZURldGVjdG9yUmVmXG4gICAgICogQHBhcmFtIHtEYXRhUHJvdmlkZXJGYWN0b3J5fSBkYXRhUHJvdmlkZXJGYWN0b3J5XG4gICAgICogQHBhcmFtIHtBdXRob3JpemF0aW9ufSBhdXRob3JpemF0aW9uU2VydmljZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGNoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgcHJpdmF0ZSBkYXRhUHJvdmlkZXJGYWN0b3J5OiBEYXRhUHJvdmlkZXJGYWN0b3J5LFxuICAgICAgICBwcml2YXRlIGF1dGhvcml6YXRpb25TZXJ2aWNlOiBBdXRob3JpemF0aW9uXG4gICAgKSB7IH1cblxuICAgIC8qKlxuICAgICAqIG5nT25Jbml0IG1ldGhvZFxuICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgKi9cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5kYXRhUHJvdmlkZXIgPSB0aGlzLmRhdGFQcm92aWRlckZhY3RvcnkuY3JlYXRlKHRoaXMudHlwZSwgdGhpcyk7XG4gICAgICAgIHRoaXMucERhdGF0YWJsZUNvbXBvbmVudC5yb3dzID0gdGhpcy5yb3dzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZVRvTG9hZGluZ0V2ZW50cygpO1xuICAgICAgICB0aGlzLmluaXRSb3dzUGVyUGFnZU9wdGlvbnNJZlByZXNlbnQoKTtcbiAgICAgICAgdGhpcy5kZWZpbmVJZlNob3VsZFNob3dIb3Jpem9udGFsQnV0dG9uc0hlYWRlcigpO1xuICAgICAgICB0aGlzLnVwZGF0ZU9uVmFsdWVDaGFuZ2UoKTtcblxuICAgICAgICB0aGlzLmZpbmlzaGVkTG9hZGluZy5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVPblZhbHVlQ2hhbmdlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHN1YnNjcmliZUZyb21WYWx1ZUNoYW5nZSBtZXRob2RcbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVPblZhbHVlQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLmZpbHRlclNlbGVjdE9wdGlvbnMgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUubWFwKChpdGVtOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlclNlbGVjdE9wdGlvbnMucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc3Vic2NyaWJlVG9Mb2FkaW5nRXZlbnRzIG1ldGhvZFxuICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgKi9cbiAgICBwcml2YXRlIHN1YnNjcmliZVRvTG9hZGluZ0V2ZW50cygpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVMb2FkaW5nQmxvY2tVSSkge1xuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEVtcHR5TWVzc2FnZSA9IHRoaXMuZW1wdHlNZXNzYWdlO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkTG9hZGluZy5zdWJzY3JpYmUoKCkgPT4gdGhpcy5vblN0YXJ0ZWRMb2FkaW5nKCkpO1xuICAgICAgICAgICAgdGhpcy5maW5pc2hlZExvYWRpbmcuc3Vic2NyaWJlKGVycm9yID0+IHRoaXMub25GaW5pc2hlZExvYWRpbmcoZXJyb3IpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIG9uU3RhcnRlZExvYWRpbmcgbWV0aG9kXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIHByaXZhdGUgb25TdGFydGVkTG9hZGluZygpIHtcbiAgICAgICAgdGhpcy5ibG9ja0NvbnRlbnQgPSB0cnVlO1xuICAgICAgICB0aGlzLmVtcHR5TWVzc2FnZSA9IHRoaXMub3JpZ2luYWxFbXB0eU1lc3NhZ2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIG9uRmluaXNoZWRMb2FkaW5nIG1ldGhvZFxuICAgICAqIEBwYXJhbSB7SHR0cEVycm9yUmVzcG9uc2V9IGVycm9yXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIHByaXZhdGUgb25GaW5pc2hlZExvYWRpbmcoZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuYmxvY2tDb250ZW50ID0gZmFsc2U7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5lbXB0eU1lc3NhZ2UgPSB0aGlzLmVycm9yTWVzc2FnZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGluaXRSb3dzUGVyUGFnZU9wdGlvbnNJZlByZXNlbnQgbWV0aG9kXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIHByaXZhdGUgaW5pdFJvd3NQZXJQYWdlT3B0aW9uc0lmUHJlc2VudCgpIHtcbiAgICAgICAgaWYgKHRoaXMucm93c1BlclBhZ2VPcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnBEYXRhdGFibGVDb21wb25lbnQucm93c1BlclBhZ2VPcHRpb25zID0gdGhpcy5yb3dzUGVyUGFnZU9wdGlvbnM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBkZWZpbmVJZlNob3VsZFNob3dIb3Jpem9udGFsQnV0dG9uc0hlYWRlciBtZXRob2RcbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgcHJpdmF0ZSBkZWZpbmVJZlNob3VsZFNob3dIb3Jpem9udGFsQnV0dG9uc0hlYWRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuaG9yaXpvbnRhbEJ1dHRvbnNIZWFkZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0hvcml6b250YWxCdXR0b25zSGVhZGVyID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIG5nQWZ0ZXJWaWV3SW5pdCBtZXRob2RcbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICB0aGlzLnNldEV4dHJhUGFyYW1zKCk7XG4gICAgICAgIHRoaXMucERhdGF0YWJsZUNvbXBvbmVudC5jb2x1bW5zID0gdGhpcy5jb2x1bW5zO1xuICAgICAgICB0aGlzLnBEYXRhdGFibGVDb21wb25lbnQubmdBZnRlckNvbnRlbnRJbml0KCk7XG4gICAgICAgIHRoaXMuc2V0QWxsQ29sdW1uc1Zpc2libGUoKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc2V0RXh0cmFQYXJhbXMgbWV0aG9kXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIHByaXZhdGUgc2V0RXh0cmFQYXJhbXMoKSB7XG4gICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5leHRyYVBhcmFtcykge1xuICAgICAgICAgICAgdGhpcy5wRGF0YXRhYmxlQ29tcG9uZW50W2ldID0gdGhpcy5leHRyYVBhcmFtc1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBuZ0FmdGVyQ29udGVudEluaXQgbWV0aG9kXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcbiAgICAgICAgdGhpcy5leHRyYUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgICBidXR0b24uY2xpY2suc3Vic2NyaWJlKGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2xpY2soYnV0dG9uLm5hbWUsIGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBvbkNsaWNrIG1ldGhvZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBidXR0b25cbiAgICAgKiBAcGFyYW0ge2FueX0gZXZlbnRcbiAgICAgKiBAcmV0dXJuIHZvaWRcbiAgICAgKi9cbiAgICBvbkNsaWNrKGJ1dHRvbjogc3RyaW5nLCBldmVudDogYW55KSB7XG4gICAgICAgIHRoaXMuYnV0dG9uQ2xpY2suZW1pdChuZXcgRGF0YXRhYmxlQ2xpY2tFdmVudChidXR0b24sIHRoaXMuc2VsZWN0ZWRSb3cpKTtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMucmVzZXRTZWxlY3RlZFJvdyhidXR0b24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIG9uU2VsZWN0Q2hhbmdlIG1ldGhvZFxuICAgICAqIEBwYXJhbSB7YW55fSBldmVudFxuICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgKi9cbiAgICBvblNlbGVjdENoYW5nZShldmVudDogYW55KSB7XG4gICAgICAgIHRoaXMub25Sb3dTZWxlY3RlZC5lbWl0KHRoaXMuc2VsZWN0ZWRSb3cpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0aGlzLnNlbGVjdGVkUm93KSAmJiB0aGlzLnNlbGVjdGVkUm93Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTXVsdGlwbGVCdXR0b25zU3RhdHVzKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVNdWx0aXBsZUJ1dHRvbnNTdGF0dXMoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdXBkYXRlTXVsdGlwbGVCdXR0b25zU3RhdHVzIG1ldGhvZFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaGFzTXVsdGlwbGVTZWxlY3Rpb25cbiAgICAgKiBAcmV0dXJuIHZvaWRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZU11bHRpcGxlQnV0dG9uc1N0YXR1cyhoYXNNdWx0aXBsZVNlbGVjdGlvbjogYm9vbGVhbikge1xuICAgICAgICB0aGlzLmV4dHJhQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgICAgICAgICAgIGlmIChoYXNNdWx0aXBsZVNlbGVjdGlvbiAmJiAhYnV0dG9uLmFsbG93TXVsdGlwbGVTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBidXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBidXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmVmcmVzaCBtZXRob2RcbiAgICAgKiBAcGFyYW0gcXVlcnlcbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgcmVmcmVzaChxdWVyeT86IGFueSkge1xuICAgICAgICB0aGlzLmRhdGFQcm92aWRlci5sb2FkKHF1ZXJ5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXNldFNlbGVjdGVkUm93IG1ldGhvZFxuICAgICAqIEBwYXJhbSBidXR0b25cbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgcmVzZXRTZWxlY3RlZFJvdyhidXR0b246IHN0cmluZykge1xuICAgICAgICBpZiAoYnV0dG9uID09PSAnZGVsZXRlJykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvdyA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXNldCBtZXRob2RcbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMucERhdGF0YWJsZUNvbXBvbmVudC5maXJzdCA9IDA7XG4gICAgICAgIHRoaXMuZGF0YVByb3ZpZGVyLnJlc2V0KCk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHBhZ2luYXRpb25Gb290ZXJUZXh0IG1ldGhvZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtc2dcbiAgICAgKiBAcmV0dXJucyBzdHJpbmdcbiAgICAgKi9cbiAgICBwYWdpbmF0aW9uRm9vdGVyVGV4dChtc2c6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHJlZ2lzdHJvcyA9IHRoaXMudG90YWxSZWNvcmRzKCkgPT09IDEgPyAncmVnaXN0cm8nIDogJ3JlZ2lzdHJvcyc7XG4gICAgICAgIGlmIChtc2cgPT09ICcnKSB7XG4gICAgICAgICAgICByZXR1cm4gYEV4aWJpbmRvOiAke3RoaXMuY3VycmVudEZpcnN0SW5kZXgoKX0gYSAke3RoaXMuY3VycmVudExhc3RJbmRleCgpfSBkZSAke3RoaXMudG90YWxSZWNvcmRzKCl9ICR7cmVnaXN0cm9zfWA7XG4gICAgICAgIH1cbiAgICAgICAgbXNnID0gbXNnLnJlcGxhY2UoJ3t0b3RhbFJlY29yZHN9JywgdGhpcy50b3RhbFJlY29yZHMoKS50b1N0cmluZygpKTtcbiAgICAgICAgbXNnID0gbXNnLnJlcGxhY2UoJ3tjdXJyZW50Rmlyc3RJbmRleH0nLCB0aGlzLmN1cnJlbnRGaXJzdEluZGV4KCkudG9TdHJpbmcoKSk7XG4gICAgICAgIG1zZyA9IG1zZy5yZXBsYWNlKCd7Y3VycmVudExhc3RJbmRleH0nLCB0aGlzLmN1cnJlbnRMYXN0SW5kZXgoKS50b1N0cmluZygpKTtcbiAgICAgICAgcmV0dXJuIG1zZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjdXJyZW50Rmlyc3RJbmRleCBtZXRob2RcbiAgICAgKiBAcmV0dXJucyBudW1iZXJcbiAgICAgKi9cbiAgICBjdXJyZW50Rmlyc3RJbmRleCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5wRGF0YXRhYmxlQ29tcG9uZW50LmZpcnN0ICsgMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjdXJyZW50TGFzdEluZGV4IG1ldGhvZFxuICAgICAqIEByZXR1cm5zIG51bWJlclxuICAgICAqL1xuICAgIGN1cnJlbnRMYXN0SW5kZXgoKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgY3VycmVudExhc3RJbmRleDogbnVtYmVyID0gdGhpcy5wRGF0YXRhYmxlQ29tcG9uZW50LmZpcnN0ICsgdGhpcy5wRGF0YXRhYmxlQ29tcG9uZW50LnJvd3M7XG4gICAgICAgIGlmIChjdXJyZW50TGFzdEluZGV4ID4gdGhpcy50b3RhbFJlY29yZHMoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG90YWxSZWNvcmRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN1cnJlbnRMYXN0SW5kZXg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdG90YWxSZWNvcmRzIG1ldGhvZFxuICAgICAqIEByZXR1cm5zIG51bWJlclxuICAgICAqL1xuICAgIHRvdGFsUmVjb3JkcygpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5wRGF0YXRhYmxlQ29tcG9uZW50LnRvdGFsUmVjb3JkcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjaGVja1JvbGVzVG9CdXR0b24gbWV0aG9kXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGJ1dHRvblxuICAgICAqIEByZXR1cm4gYm9vbGVhblxuICAgICAqL1xuICAgIGNoZWNrUm9sZXNUb0J1dHRvbihidXR0b246IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpc1tidXR0b25dKSB7XG4gICAgICAgICAgICBpZiAoYnV0dG9uID09PSAncnVsZXNUb0hpZGUnIHx8IGJ1dHRvbiA9PT0gJ3J1bGVzVG9TaG93RWRpdCcgfHwgYnV0dG9uID09PSAncnVsZXNUb1Nob3dEZWxldGUnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja1VzZUJ1dHRvbnMoYnV0dG9uKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRob3JpemF0aW9uU2VydmljZS5oYXNSb2xlKHRoaXNbYnV0dG9uXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gIXRoaXMuYXV0aG9yaXphdGlvblNlcnZpY2UuaGFzUm9sZSh0aGlzW2J1dHRvbl0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNoZWNrVXNlQnV0dG9ucyBtZXRob2RcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYnV0dG9uXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIGNoZWNrVXNlQnV0dG9ucyhidXR0b246IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAodGhpc1tidXR0b25dICYmIHRoaXNbYnV0dG9uLnJlcGxhY2UoJ1Nob3cnLCAnSGlkZScpXSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOw6NvIMOpIHBvc3PDrXZlbCBkZWZpbmlyIGRvaXMgdmFsb3JlcyBkZSByb2xlcyBwYXJhIG9zIGJvdMO1ZXMgcGFkcsO1ZXMuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBmaWx0ZXIgbWV0aG9kXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIGZpbHRlcigpIHtcbiAgICAgICAgZm9yIChsZXQgcHJvcCBpbiB0aGlzLmZpbHRlclBhcmFtcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuZmlsdGVyUGFyYW1zW3Byb3BdID09PSAnJyB8fCAodGhpcy5maWx0ZXJQYXJhbXNbcHJvcF0ubGVuZ3RoID09PSAwKSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZpbHRlclBhcmFtc1twcm9wXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcy5maWx0ZXJQYXJhbXMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKHRoaXMuZmlsdGVyUGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcGFyYSBmaWx0cmFyIHBvciBjb2x1bmFzXG4gICAgICogQHBhcmFtIGNvbHVtbiBjaGF2ZSBkYSBjb2x1bmEgbmEgdGFiZWxhXG4gICAgICogQHBhcmFtIGZpbHRlcnMgdmFsb3IgZG8gZmlsdHJvXG4gICAgICovXG4gICAgZmlsdGVyQ29sdW1uKGNvbHVtbjogc3RyaW5nLCBmaWx0ZXJzOiBhbnkpIHtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgICAgIGlmIChmaWx0ZXJzIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgIHZhbHVlc1tjb2x1bW5dID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIGZpbHRlcnMpIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsID0gKGZpbHRlcnNbaXRlbV0gaW5zdGFuY2VvZiBPYmplY3QpPyBmaWx0ZXJzW2l0ZW1dLnZhbHVlIDogZmlsdGVyc1tpdGVtXTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbY29sdW1uXS5wdXNoKHZhbClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlc1tjb2x1bW5dID0gZmlsdGVycztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZpbHRlclBhcmFtcyA9IHsgLi4udGhpcy5maWx0ZXJQYXJhbXMsIC4uLnZhbHVlcyB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pY2lhIHRvZGFzIGFzIGNvbHVuYXMgZGEgdGFiZWxhIGNvbW8gdmlzw612ZWlzXG4gICAgICovXG4gICAgc2V0QWxsQ29sdW1uc1Zpc2libGUoKSB7XG4gICAgICAgIHRoaXMuY29sdW1ucy5mb3JFYWNoKChjb2wpID0+IHtcbiAgICAgICAgICAgIHRoaXMudmlzaWJsZUNvbHVtbnNbY29sLmZpZWxkXSA9ICd0YWJsZS1jZWxsJztcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmVyaWZpY2Egc2UgdW1hIGNvbHVuYSBkZXZlIGVzdGFyIHZpc8OtdmVsXG4gICAgICogQHBhcmFtIGNvbHVtbiBzdHJpbmdcbiAgICAgKiBAcGFyYW0gdmlzaWJsZUNvbHVtbnMgQXJyYXlcbiAgICAgKi9cbiAgICB2aXNpYmxlQ29sdW1uQ2hlY2soY29sdW1uOiBzdHJpbmcsIHZpc2libGVDb2x1bW5zOiBbXSkge1xuICAgICAgICByZXR1cm4gdmlzaWJsZUNvbHVtbnMuc29tZSgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKGl0ZW0uZmllbGQpID8gaXRlbS5maWVsZCA9PSBjb2x1bW4gOiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBdHVhbHppYSBvcyB2YWxvcmVzIGRhIHZhcmnDoXZlbCAndmlzaWJsZUNvbHVucycgcGFyYSBtb3N0cmFyIG91IG7Do28gYXMgY29sdW5hc1xuICAgICAqIEBwYXJhbSBjb2x1bW5zIGFycmF5XG4gICAgICovXG4gICAgdXBkYXRlVmlzaWJsZUNvbHVtbnMoY29sdW1uczogW10pIHtcbiAgICAgICAgZm9yIChsZXQgY29sIGluIHRoaXMudmlzaWJsZUNvbHVtbnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZpc2libGVDb2x1bW5DaGVjayhjb2wsIGNvbHVtbnMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlQ29sdW1uc1tjb2xdID0gJ3RhYmxlLWNlbGwnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpc2libGVDb2x1bW5zW2NvbF0gPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvblJvd0VkaXRJbml0RXZlbnQoZXZlbnQsIHJvd0RhdGE6IGFueSkge1xuXG4gICAgICAgIGNvbnN0IHRyID0gZXZlbnQuc3JjRWxlbWVudC5jbG9zZXN0KCd0cicpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lZGl0aW5nUm93ID0gdHJ1ZTtcblxuICAgICAgICAgICAgY29uc3QgdG9wID0gdHIub2Zmc2V0VG9wO1xuICAgICAgICAgICAgY29uc3QgaGVpZ2h0ID0gdHIub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgY29uc3QgZWRpdEJ1dHRvbnMgPSB0ci5xdWVyeVNlbGVjdG9yKCcuZWRpdGFyLWNhbXBvcycpO1xuXG4gICAgICAgICAgICBlZGl0QnV0dG9ucy5zdHlsZS50b3AgPSAodG9wICsgaGVpZ2h0IC0gNzUpICsgJ3B4JztcbiAgICAgICAgICAgIGVkaXRCdXR0b25zLnN0eWxlLmhlaWdodCA9Jzc1cHgnO1xuICAgICAgICAgICAgZWRpdEJ1dHRvbnMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNkMGQwZDAnO1xuICAgICAgICAgICAgZWRpdEJ1dHRvbnMuc3R5bGUub3BhY2l0eSA9IDE7XG5cbiAgICAgICAgICAgIHRoaXMuY2xvbmVkUm93RGF0YVtyb3dEYXRhLmlkXSA9IHsuLi5yb3dEYXRhfTtcbiAgICAgICAgICAgIHRoaXMub25Sb3dFZGl0RXZlbnQuZW1pdCh7ZXZlbnQ6IFwiaW5pdFwiLCBkYXRhOiByb3dEYXRhfSk7XG4gICAgICAgIH0sIG51bGwgLCB0cik7XG5cbiAgICB9XG5cbiAgICBvblJvd0VkaXRTYXZlRXZlbnQoZXZlbnQsIHJvd0RhdGE6IGFueSkge1xuICAgICAgICB0aGlzLm9uUm93RWRpdEV2ZW50LmVtaXQoe2V2ZW50OiBcInNhdmVcIiwgZGF0YTogcm93RGF0YX0pO1xuICAgICAgICB0aGlzLnJlc2V0RWRpdGluZ01vZGUoZXZlbnQpO1xuICAgIH1cblxuICAgIG9uUm93RWRpdENhbmNlbEV2ZW50KGV2ZW50LCByb3dEYXRhOiBhbnksIGluZGV4OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy52YWx1ZVtpbmRleF0gPSB0aGlzLmNsb25lZFJvd0RhdGFbcm93RGF0YS5pZF07XG5cbiAgICAgICAgZGVsZXRlIHRoaXMuY2xvbmVkUm93RGF0YVtyb3dEYXRhW3RoaXMuZGF0YUtleV1dO1xuICAgICAgICB0aGlzLm9uUm93RWRpdEV2ZW50LmVtaXQoe2V2ZW50OiBcImNhbmNlbFwiLCBkYXRhOiByb3dEYXRhfSk7XG5cbiAgICAgICAgdGhpcy5yZXNldEVkaXRpbmdNb2RlKGV2ZW50KTtcbiAgICB9XG5cbiAgICByZXNldEVkaXRpbmdNb2RlKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGVkaXRCdXR0b25zID0gZXZlbnQuc3JjRWxlbWVudC5jbG9zZXN0KCd0cicpLnF1ZXJ5U2VsZWN0b3IoJy5lZGl0YXItY2FtcG9zJyk7XG5cbiAgICAgICAgZWRpdEJ1dHRvbnMuc3R5bGUub3BhY2l0eSA9IDA7XG4gICAgICAgIGVkaXRCdXR0b25zLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjMDAwMDAwNmInO1xuICAgICAgICBlZGl0QnV0dG9ucy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG4gICAgICAgIHRoaXMuZWRpdGluZ1JvdyA9IGZhbHNlO1xuICAgIH1cblxuICAgIGVkaXRhckxpbmhhT3ZlcihldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMuZWRpdGluZ1JvdyAmJiB0aGlzLmVkaXRNb2RlID09ICdyb3cnKSB7XG4gICAgICAgICAgICBjb25zdCB0b3AgPSBldmVudC5zcmNFbGVtZW50LmNsb3Nlc3QoJ3RyJykub2Zmc2V0VG9wO1xuICAgICAgICAgICAgY29uc3QgaGVpZ2h0ID0gZXZlbnQuc3JjRWxlbWVudC5jbG9zZXN0KCd0cicpLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIGNvbnN0IGVkaXRCdXR0b25zID0gZXZlbnQuc3JjRWxlbWVudC5jbG9zZXN0KCd0cicpLnF1ZXJ5U2VsZWN0b3IoJy5lZGl0YXItY2FtcG9zJyk7XG5cbiAgICAgICAgICAgIGVkaXRCdXR0b25zLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgICAgICBlZGl0QnV0dG9ucy5zdHlsZS50b3AgPSB0b3AgKyAncHgnO1xuICAgICAgICAgICAgZWRpdEJ1dHRvbnMuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIGVkaXRCdXR0b25zLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjMDAwMDAwNmInO1xuICAgICAgICAgICAgZWRpdEJ1dHRvbnMuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBlZGl0YXJMaW5oYU91dChldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMuZWRpdGluZ1Jvdykge1xuICAgICAgICAgICAgY29uc3QgZWRpdEJ1dHRvbnMgPSBldmVudC5zcmNFbGVtZW50LmNsb3Nlc3QoJ3RyJykucXVlcnlTZWxlY3RvcignLmVkaXRhci1jYW1wb3MnKTtcbiAgICAgICAgICAgIGVkaXRCdXR0b25zLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBlZGl0QnV0dG9ucy5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxufVxuIl19