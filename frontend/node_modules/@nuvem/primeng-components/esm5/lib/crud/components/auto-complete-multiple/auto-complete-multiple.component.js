import { __decorate, __extends } from "tslib";
import { Component, Input } from "@angular/core";
import { provideValueAccessor } from "@nuvem/angular-base";
import { FieldComponent } from "../field.component";
import { forkJoin } from 'rxjs';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../../../form-notification/form-notification.component';
import * as ɵngcc2 from '../auto-complete/auto-complete-custom.component';
import * as ɵngcc3 from '@angular/forms';
import * as ɵngcc4 from '@angular/common';
import * as ɵngcc5 from '../validation-message/validation-message.component';

var _c0 = ["nAutoCompleteMultiple", ""];
function AutoCompleteMultipleComponent_nValidationMessage_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "nValidationMessage", 6);
} if (rf & 2) {
    var ctx_r1030 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("control", ctx_r1030.formControl);
} }
var _c1 = ["*"];
var AutoCompleteMultipleComponent = /** @class */ (function (_super) {
    __extends(AutoCompleteMultipleComponent, _super);
    function AutoCompleteMultipleComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.virtualScroll = false;
        _this.itemSize = 30;
        return _this;
    }
    AutoCompleteMultipleComponent_1 = AutoCompleteMultipleComponent;
    AutoCompleteMultipleComponent.prototype.findAll = function (event) {
        var _this = this;
        var query = {};
        query[this.field] = event.query;
        this.service.findAll(query).subscribe(function (data) {
            _this.results = data;
        });
    };
    AutoCompleteMultipleComponent.prototype.outerToInner = function (value) {
        var _this = this;
        if (value && value.length > 0 && !value[0][this.field]) {
            var obs_1 = [];
            value.forEach(function (element) {
                if (element && element.id) {
                    obs_1.push(_this.service.find(element.id));
                }
            });
            forkJoin(obs_1).subscribe(function (data) {
                _this.formControl.setValue(data);
            });
        }
        return value;
    };
    var AutoCompleteMultipleComponent_1;
    __decorate([
        Input()
    ], AutoCompleteMultipleComponent.prototype, "field", void 0);
    __decorate([
        Input()
    ], AutoCompleteMultipleComponent.prototype, "service", void 0);
    __decorate([
        Input()
    ], AutoCompleteMultipleComponent.prototype, "virtualScroll", void 0);
    __decorate([
        Input()
    ], AutoCompleteMultipleComponent.prototype, "itemSize", void 0);
AutoCompleteMultipleComponent.ɵfac = function AutoCompleteMultipleComponent_Factory(t) { return ɵAutoCompleteMultipleComponent_BaseFactory(t || AutoCompleteMultipleComponent); };
AutoCompleteMultipleComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AutoCompleteMultipleComponent, selectors: [["", "nAutoCompleteMultiple", ""]], inputs: { field: "field", service: "service", virtualScroll: "virtualScroll", itemSize: "itemSize" }, features: [ɵngcc0.ɵɵProvidersFeature([provideValueAccessor(AutoCompleteMultipleComponent_1)]), ɵngcc0.ɵɵInheritDefinitionFeature], attrs: _c0, ngContentSelectors: _c1, decls: 7, vars: 11, consts: [["form-notification", "", 1, "md-inputfield", 3, "name", "form"], ["notification", ""], [3, "formControl", "suggestions", "field", "virtualScroll", "itemSize", "multiple", "completeMethod", "onBlur", "onSelect", "onFocus"], ["input", ""], [3, "for", "innerHTML"], [3, "control", 4, "ngIf"], [3, "control"]], template: function AutoCompleteMultipleComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef();
        ɵngcc0.ɵɵelementStart(0, "span", 0, 1);
        ɵngcc0.ɵɵelementStart(2, "p-autoCompleteCustom", 2, 3);
        ɵngcc0.ɵɵlistener("completeMethod", function AutoCompleteMultipleComponent_Template_p_autoCompleteCustom_completeMethod_2_listener($event) { return ctx.findAll($event); })("onBlur", function AutoCompleteMultipleComponent_Template_p_autoCompleteCustom_onBlur_2_listener($event) { return ctx.onBlurEvent($event); })("onSelect", function AutoCompleteMultipleComponent_Template_p_autoCompleteCustom_onSelect_2_listener($event) { return ctx.onSelectEvent($event); })("onFocus", function AutoCompleteMultipleComponent_Template_p_autoCompleteCustom_onFocus_2_listener($event) { return ctx.onFocusEvent($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelement(4, "label", 4);
        ɵngcc0.ɵɵtemplate(5, AutoCompleteMultipleComponent_nValidationMessage_5_Template, 1, 1, "nValidationMessage", 5);
        ɵngcc0.ɵɵprojection(6);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        var _r1028 = ɵngcc0.ɵɵreference(1);
        ɵngcc0.ɵɵproperty("name", ctx.name)("form", ctx.form);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("formControl", ctx.formControl)("suggestions", ctx.results)("field", ctx.field)("virtualScroll", ctx.virtualScroll)("itemSize", ctx.itemSize)("multiple", true);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("for", ctx.name)("innerHTML", ctx.label, ɵngcc0.ɵɵsanitizeHtml);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !_r1028.message);
    } }, directives: [ɵngcc1.FormNotificationComponent, ɵngcc2.AutoCompleteCustomComponent, ɵngcc3.NgControlStatus, ɵngcc3.FormControlDirective, ɵngcc4.NgIf, ɵngcc5.ValidationMessageComponent], encapsulation: 2 });
var ɵAutoCompleteMultipleComponent_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(AutoCompleteMultipleComponent);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AutoCompleteMultipleComponent, [{
        type: Component,
        args: [{
                selector: "[nAutoCompleteMultiple]",
                template: "<span #notification form-notification class=\"md-inputfield\" [name]=\"name\" [form]=\"form\">\n    <p-autoCompleteCustom #input\n        [formControl]=\"formControl\"\n        [suggestions]=\"results\"\n        (completeMethod)=\"findAll($event)\"\n        [field]=\"field\"\n        [virtualScroll]=\"virtualScroll\"\n        [itemSize]=\"itemSize\"\n        (onBlur)=\"onBlurEvent($event)\"\n        (onSelect)=\"onSelectEvent($event)\"\n        (onFocus)=\"onFocusEvent($event)\"\n        [multiple]=\"true\">\n    </p-autoCompleteCustom>\n    <label [for]=\"name\" [innerHTML]=\"label\"></label>\n    <nValidationMessage [control]=\"formControl\" *ngIf=\"!notification.message\"></nValidationMessage>\n    <ng-content></ng-content>\n</span>\n",
                providers: [provideValueAccessor(AutoCompleteMultipleComponent_1)]
            }]
    }], null, { field: [{
            type: Input
        }], service: [{
            type: Input
        }], virtualScroll: [{
            type: Input
        }], itemSize: [{
            type: Input
        }] }); })();
    return AutoCompleteMultipleComponent;
}(FieldComponent));
export { AutoCompleteMultipleComponent };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0by1jb21wbGV0ZS1tdWx0aXBsZS5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIm5nOi9AbnV2ZW0vcHJpbWVuZy1jb21wb25lbnRzL2xpYi9jcnVkL2NvbXBvbmVudHMvYXV0by1jb21wbGV0ZS1tdWx0aXBsZS9hdXRvLWNvbXBsZXRlLW11bHRpcGxlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDakQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDM0QsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBRXBELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxNQUFNLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7QUFPaEM7QUFBdUUsSUFBcEIsaURBQXFCO0FBQUMsSUFBekU7QUFBMkMsUUFBM0MscUVBbUNDO0FBQ0QsUUE5QmEsbUJBQWEsR0FBWSxLQUFLLENBQUM7QUFDNUMsUUFDYSxjQUFRLEdBQVcsRUFBRSxDQUFDO0FBQ25DO0FBR0EsSUF1QkEsQ0FBQztBQUNELHNDQXBDYSw2QkFBNkI7QUFBRSxJQVl4QywrQ0FBTyxHQUFQLFVBQVEsS0FBVTtBQUN0QixRQURJLGlCQU1DO0FBQ0wsUUFOUSxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDdkIsUUFBUSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7QUFDeEMsUUFBUSxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxJQUFJO0FBQUksWUFDMUMsS0FBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7QUFDaEMsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUNYLElBQUksQ0FBQztBQUVMLElBQWMsb0RBQVksR0FBdEIsVUFBdUIsS0FBWTtBQUFJLFFBQXZDLGlCQWFDO0FBQ0wsUUFiUSxJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7QUFDaEUsWUFBWSxJQUFJLEtBQUcsR0FBVSxFQUFFLENBQUM7QUFDaEMsWUFBWSxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQUEsT0FBTztBQUFJLGdCQUNyQixJQUFJLE9BQU8sSUFBSSxPQUFPLENBQUMsRUFBRSxFQUFFO0FBQzNDLG9CQUFvQixLQUFHLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQzVELGlCQUFpQjtBQUNqQixZQUFZLENBQUMsQ0FBQyxDQUFDO0FBQ2YsWUFBWSxRQUFRLENBQUMsS0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLFVBQUMsSUFBSTtBQUFJLGdCQUM3QixLQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNoRCxZQUFZLENBQUMsQ0FBQyxDQUFDO0FBQ2YsU0FBUztBQUNULFFBQVEsT0FBTyxLQUFLLENBQUM7QUFDckIsSUFBSSxDQUFDO0FBRUw7QUFDdUMsSUFsQzFCO0FBQWEsUUFBckIsS0FBSyxFQUFFO0FBQUMsZ0VBQWM7QUFFM0IsSUFBYTtBQUFhLFFBQXJCLEtBQUssRUFBRTtBQUFDLGtFQUErQjtBQUU1QyxJQUFhO0FBQWEsUUFBckIsS0FBSyxFQUFFO0FBQUMsd0VBQStCO0FBRTVDLElBQWE7QUFBYSxRQUFyQixLQUFLLEVBQUU7QUFBQyxtRUFBc0I7SUFSdEIsNkJBQTZCLDBEQUx6QyxTQUFTLENBQUMsY0FDUCxRQUFRLEVBQUUseUJBQXlCLGNBQ25DO3d1QkFBc0QsY0FDdEQsU0FBUyxFQUFFLENBQUMsb0JBQW9CLENBQUMsK0JBQTZCLENBQUMsQ0FBQyxVQUNuRSxDQUFDO0lBQ1csNkJBQTZCO0FBbUN6Qzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFDRDtBQUFDLElBREQsb0NBQUM7QUFDQSxDQURBLEFBbkNELENBQW1ELGNBQWMsR0FtQ2hFO0FBQ0QsU0FwQ2EsNkJBQTZCO0FBQUkiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0IH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IHByb3ZpZGVWYWx1ZUFjY2Vzc29yIH0gZnJvbSBcIkBudXZlbS9hbmd1bGFyLWJhc2VcIjtcbmltcG9ydCB7IEZpZWxkQ29tcG9uZW50IH0gZnJvbSBcIi4uL2ZpZWxkLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgQ3J1ZFNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vY3J1ZC1zZXJ2aWNlLnNlcnZpY2VcIjtcbmltcG9ydCB7IGZvcmtKb2luIH0gZnJvbSAncnhqcyc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiBcIltuQXV0b0NvbXBsZXRlTXVsdGlwbGVdXCIsXG4gICAgdGVtcGxhdGVVcmw6IFwiLi9hdXRvLWNvbXBsZXRlLW11bHRpcGxlLmNvbXBvbmVudC5odG1sXCIsXG4gICAgcHJvdmlkZXJzOiBbcHJvdmlkZVZhbHVlQWNjZXNzb3IoQXV0b0NvbXBsZXRlTXVsdGlwbGVDb21wb25lbnQpXSxcbn0pXG5leHBvcnQgY2xhc3MgQXV0b0NvbXBsZXRlTXVsdGlwbGVDb21wb25lbnQgZXh0ZW5kcyBGaWVsZENvbXBvbmVudDxhbnlbXT4ge1xuXG4gICAgQElucHV0KCkgZmllbGQ6IHN0cmluZztcblxuICAgIEBJbnB1dCgpIHNlcnZpY2U6IENydWRTZXJ2aWNlPGFueSwgYW55PjtcblxuICAgIEBJbnB1dCgpIHZpcnR1YWxTY3JvbGw6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIEBJbnB1dCgpIGl0ZW1TaXplOiBudW1iZXIgPSAzMDtcblxuICAgIHJlc3VsdHM6IGFueVtdO1xuXG4gICAgZmluZEFsbChldmVudDogYW55KSB7XG4gICAgICAgIGxldCBxdWVyeSA9IHt9O1xuICAgICAgICBxdWVyeVt0aGlzLmZpZWxkXSA9IGV2ZW50LnF1ZXJ5O1xuICAgICAgICB0aGlzLnNlcnZpY2UuZmluZEFsbChxdWVyeSkuc3Vic2NyaWJlKGRhdGEgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRzID0gZGF0YTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG91dGVyVG9Jbm5lcih2YWx1ZTogYW55W10pOiBhbnlbXSB7XG4gICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggPiAwICYmICF2YWx1ZVswXVt0aGlzLmZpZWxkXSkge1xuICAgICAgICAgICAgbGV0IG9iczogYW55W10gPSBbXTtcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5pZCkge1xuICAgICAgICAgICAgICAgICAgICBvYnMucHVzaCh0aGlzLnNlcnZpY2UuZmluZChlbGVtZW50LmlkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmb3JrSm9pbihvYnMpLnN1YnNjcmliZSgoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybUNvbnRyb2wuc2V0VmFsdWUoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG59XG4iXX0=