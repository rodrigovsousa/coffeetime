import { __decorate, __param } from "tslib";
import { Component, Inject, Input, Output, EventEmitter } from "@angular/core";
import { CRUD_SERVICE } from "./crud-service.service";
import { Router, ActivatedRoute } from "@angular/router";
var FormComponent = /** @class */ (function () {
    function FormComponent(crudService, activatedRoute, router) {
        this.crudService = crudService;
        this.activatedRoute = activatedRoute;
        this.router = router;
        this.action = "save";
        this.saveLabel = "Salvar";
        this.disableSave = false;
        this.save = new EventEmitter();
        this.reset = new EventEmitter();
    }
    FormComponent.prototype.ngOnInit = function () {
        if (this.service) {
            this.crudService = this.service;
        }
    };
    FormComponent.prototype.submit = function () {
        var _this = this;
        if (this.save.observers.length) {
            this.save.emit(this.form.value);
        }
        else {
            this.crudService[this.action](this.form.value)
                .subscribe(function () {
                if (_this.route) {
                    _this.router.navigate(_this.route, { relativeTo: _this.activatedRoute });
                }
                else if (_this.reset.observers.length) {
                    _this.reset.emit(_this.form);
                }
                else {
                    _this.form.reset();
                }
            });
        }
    };
    FormComponent.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [CRUD_SERVICE,] }] },
        { type: ActivatedRoute },
        { type: Router }
    ]; };
    __decorate([
        Input()
    ], FormComponent.prototype, "form", void 0);
    __decorate([
        Input()
    ], FormComponent.prototype, "route", void 0);
    __decorate([
        Input()
    ], FormComponent.prototype, "action", void 0);
    __decorate([
        Input()
    ], FormComponent.prototype, "saveLabel", void 0);
    __decorate([
        Input()
    ], FormComponent.prototype, "service", void 0);
    __decorate([
        Input()
    ], FormComponent.prototype, "disableSave", void 0);
    __decorate([
        Output()
    ], FormComponent.prototype, "save", void 0);
    __decorate([
        Output()
    ], FormComponent.prototype, "reset", void 0);
    FormComponent = __decorate([
        Component({
            selector: 'nForm',
            template: "<div>\n    <form (submit)=\"submit()\" class=\"ui-g form-group\">\n        <ng-content></ng-content>\n        <div class=\"ui-g-12 ui-lg-2 ui-md-4 ui-sm-12\" *ngIf=\"!disableSave\">\n            <button pButton type=\"submit\" [label]=\"saveLabel\" [disabled]=\"form.disabled || form.invalid\"></button>\n        </div>\n        <ng-content select=\"[nButton]\"></ng-content>\n    </form>\n</div>"
        }),
        __param(0, Inject(CRUD_SERVICE))
    ], FormComponent);
    return FormComponent;
}());
export { FormComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AbnV2ZW0vcHJpbWVuZy1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsibGliL2NydWQvZm9ybS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXZGLE9BQU8sRUFBZSxZQUFZLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRSxPQUFPLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBTXpEO0lBaUJJLHVCQUVZLFdBQWtDLEVBQ2xDLGNBQThCLEVBQzlCLE1BQWM7UUFGZCxnQkFBVyxHQUFYLFdBQVcsQ0FBdUI7UUFDbEMsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFmakIsV0FBTSxHQUFXLE1BQU0sQ0FBQztRQUV4QixjQUFTLEdBQVcsUUFBUSxDQUFDO1FBSTdCLGdCQUFXLEdBQVksS0FBSyxDQUFDO1FBRTVCLFNBQUksR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUVsRCxVQUFLLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7SUFNMUQsQ0FBQztJQUVKLGdDQUFRLEdBQVI7UUFDSSxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDZCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7U0FDbkM7SUFDTCxDQUFDO0lBRUQsOEJBQU0sR0FBTjtRQUFBLGlCQWVDO1FBZEcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7WUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNuQzthQUFNO1lBQ0gsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7aUJBQzdDLFNBQVMsQ0FBQztnQkFDUCxJQUFJLEtBQUksQ0FBQyxLQUFLLEVBQUU7b0JBQ1osS0FBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSSxDQUFDLEtBQUssRUFBRSxFQUFFLFVBQVUsRUFBRSxLQUFJLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQztpQkFDekU7cUJBQU0sSUFBSSxLQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7b0JBQ3BDLEtBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztpQkFDOUI7cUJBQU07b0JBQ0gsS0FBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztpQkFDckI7WUFDTCxDQUFDLENBQUMsQ0FBQztTQUNOO0lBQ0wsQ0FBQzs7Z0RBM0JJLE1BQU0sU0FBQyxZQUFZO2dCQUVJLGNBQWM7Z0JBQ3RCLE1BQU07O0lBbkJqQjtRQUFSLEtBQUssRUFBRTsrQ0FBaUI7SUFFaEI7UUFBUixLQUFLLEVBQUU7Z0RBQVc7SUFFVjtRQUFSLEtBQUssRUFBRTtpREFBeUI7SUFFeEI7UUFBUixLQUFLLEVBQUU7b0RBQThCO0lBRTdCO1FBQVIsS0FBSyxFQUFFO2tEQUFnQztJQUUvQjtRQUFSLEtBQUssRUFBRTtzREFBOEI7SUFFNUI7UUFBVCxNQUFNLEVBQUU7K0NBQW1EO0lBRWxEO1FBQVQsTUFBTSxFQUFFO2dEQUFvRDtJQWhCcEQsYUFBYTtRQUp6QixTQUFTLENBQUM7WUFDUCxRQUFRLEVBQUUsT0FBTztZQUNqQix3WkFBb0M7U0FDdkMsQ0FBQztRQW1CTyxXQUFBLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQTtPQWxCaEIsYUFBYSxDQStDekI7SUFBRCxvQkFBQztDQUFBLEFBL0NELElBK0NDO1NBL0NZLGFBQWEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5qZWN0LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgRm9ybUdyb3VwIH0gZnJvbSBcIkBhbmd1bGFyL2Zvcm1zXCI7XG5pbXBvcnQgeyBDcnVkU2VydmljZSwgQ1JVRF9TRVJWSUNFIH0gZnJvbSBcIi4vY3J1ZC1zZXJ2aWNlLnNlcnZpY2VcIjtcbmltcG9ydCB7IFJvdXRlciwgQWN0aXZhdGVkUm91dGUgfSBmcm9tIFwiQGFuZ3VsYXIvcm91dGVyXCI7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnbkZvcm0nLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9mb3JtLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBGb3JtQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAgIEBJbnB1dCgpIGZvcm06IEZvcm1Hcm91cDtcblxuICAgIEBJbnB1dCgpIHJvdXRlOiBbXTtcblxuICAgIEBJbnB1dCgpIGFjdGlvbjogc3RyaW5nID0gXCJzYXZlXCI7XG5cbiAgICBASW5wdXQoKSBzYXZlTGFiZWw6IHN0cmluZyA9IFwiU2FsdmFyXCI7XG5cbiAgICBASW5wdXQoKSBzZXJ2aWNlOiBDcnVkU2VydmljZTxhbnksIGFueT47XG5cbiAgICBASW5wdXQoKSBkaXNhYmxlU2F2ZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgQE91dHB1dCgpIHNhdmU6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICBAT3V0cHV0KCkgcmVzZXQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIEBJbmplY3QoQ1JVRF9TRVJWSUNFKVxuICAgICAgICBwcml2YXRlIGNydWRTZXJ2aWNlOiBDcnVkU2VydmljZTxhbnksIGFueT4sXG4gICAgICAgIHByaXZhdGUgYWN0aXZhdGVkUm91dGU6IEFjdGl2YXRlZFJvdXRlLFxuICAgICAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyXG4gICAgKSB7fVxuXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnNlcnZpY2UpIHtcbiAgICAgICAgICAgIHRoaXMuY3J1ZFNlcnZpY2UgPSB0aGlzLnNlcnZpY2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdWJtaXQoKSB7XG4gICAgICAgIGlmICh0aGlzLnNhdmUub2JzZXJ2ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5zYXZlLmVtaXQodGhpcy5mb3JtLnZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY3J1ZFNlcnZpY2VbdGhpcy5hY3Rpb25dKHRoaXMuZm9ybS52YWx1ZSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKHRoaXMucm91dGUsIHsgcmVsYXRpdmVUbzogdGhpcy5hY3RpdmF0ZWRSb3V0ZSB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVzZXQub2JzZXJ2ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0LmVtaXQodGhpcy5mb3JtKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0ucmVzZXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufVxuIl19