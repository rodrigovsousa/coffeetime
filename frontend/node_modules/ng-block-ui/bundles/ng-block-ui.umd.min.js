!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("rxjs"),require("@angular/core")):"function"==typeof define&&define.amd?define("ng-block-ui",["exports","@angular/common","rxjs","@angular/core"],e):e(t["ng-block-ui"]={},t.ng.common,t.rxjs,t.ng.core)}(this,function(t,n,e,o){"use strict";var i=function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(){function t(){}return t.START="start",t.STOP="stop",t.UPDATE="update",t.RESET="reset",t.UNSUBSCRIBE="unsubscribe",t}(),a="block-ui-main",r=function(){function t(){this.blockUISettings={},this.blockUIInstances={},this.blockUISubject=new e.ReplaySubject,this.blockUIObservable=this.blockUISubject.asObservable(),this.blockUIObservable.subscribe(this.blockUIMiddleware.bind(this))}return t.prototype.getSettings=function(){return this.blockUISettings},t.prototype.updateSettings=function(t){void 0===t&&(t={}),this.blockUISettings=i({},this.blockUISettings,t)},t.prototype.decorate=function(t){void 0===t&&(t=a);var e={name:t,isActive:!1,blockCount:0,start:this.dispatch(this.blockUISubject,s.START,t),update:this.dispatch(this.blockUISubject,s.UPDATE,t),stop:this.dispatch(this.blockUISubject,s.STOP,t),reset:this.dispatch(this.blockUISubject,s.RESET,t),unsubscribe:this.dispatch(this.blockUISubject,s.UNSUBSCRIBE,t)};return this.blockUIInstances[t]=this.blockUIInstances[t]||e,e},t.prototype.observe=function(){return this.blockUIObservable},t.prototype.blockUIMiddleware=function(t){var e=t.action,n=t.name,o=null;switch(e){case s.START:o=!0;break;case s.STOP:case s.RESET:o=!1}null!==o&&(this.blockUIInstances[n].isActive=o)},t.prototype.dispatch=function(e,n,o){return void 0===o&&(o=a),function(t){e.next({name:o,action:n,message:t})}},t.decorators=[{type:o.Injectable}],t.ctorParameters=function(){return[]},t}(),c=function(){function t(t){this.blockUI=t}return t.prototype.ngOnInit=function(){this.name=this.name||a,this.template=this.template||this.blockUI.blockUISettings.template},t.decorators=[{type:o.Component,args:[{selector:"block-ui",template:'\n    <ng-content></ng-content>\n    <block-ui-content\n      [name]="name"\n      [message]="message"\n      [template]="template"\n      [delayStart]="delayStart"\n      [delayStop]="delayStop"\n    >\n    </block-ui-content>\n  ',encapsulation:o.ViewEncapsulation.None}]}],t.ctorParameters=function(){return[{type:r}]},t.propDecorators={name:[{type:o.Input}],message:[{type:o.Input}],delayStart:[{type:o.Input}],delayStop:[{type:o.Input}],template:[{type:o.Input}]},t}(),l="\n.block-ui-wrapper {\n  display: none;\n  position: fixed;\n  height: 100%;\n  width: 100%;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.70);\n  z-index: 30000;\n  cursor: wait;\n}\n\n.block-ui-wrapper.block-ui-wrapper--element {\n  position: absolute;\n}\n\n.block-ui-wrapper.active {\n  display: block;\n}\n\n.block-ui-wrapper.block-ui-main {\n  position: fixed;\n}\n\n.block-ui-spinner,\n.block-ui-template {\n  position: absolute;\n  top: 40%;\n  margin: 0 auto;\n  left: 0;\n  right: 0;\n  transform: translateY(-50%);\n}\n\n.block-ui-spinner > .message {\n  font-size: 1.3em;\n  text-align: center;\n  color: #fff;\n}\n\n.block-ui__element {\n  position: relative;\n}\n\n.loader,\n.loader:after {\n  border-radius: 50%;\n  width: 10em;\n  height: 10em;\n}\n.loader {\n  margin: 7px auto;\n  font-size: 5px;\n  position: relative;\n  text-indent: -9999em;\n  border-top: 1.1em solid rgba(255, 255, 255, 0.2);\n  border-right: 1.1em solid rgba(255, 255, 255, 0.2);\n  border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);\n  border-left: 1.1em solid #ffffff;\n  -webkit-transform: translateZ(0);\n  -ms-transform: translateZ(0);\n  transform: translateZ(0);\n  -webkit-animation: load8 1.1s infinite linear;\n  animation: load8 1.1s infinite linear;\n}\n\n@-webkit-keyframes load8 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes load8 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",p='\n<div class="block-ui-wrapper {{name}} {{className}}" [ngClass]="{ \'active\': active }">\n  <div class="block-ui-spinner" *ngIf="!templateCmp">\n    <div class="loader"></div>\n    <div *ngIf="message || defaultMessage" class="message">\n      {{ message || defaultMessage }}\n    </div>\n  </div>\n  <ng-template *ngIf="templateCmp" #templateOutlet></ng-template>\n</div>\n',u=function(){function t(t,e,n){this.blockUI=t,this.resolver=e,this.changeDetectionRef=n,this.name=a,this.delayStart=0,this.delayStop=0,this.state={startTimeout:null,stopTimeout:null,blockCount:0},this.active=!1}return t.prototype.ngOnInit=function(){this.settings=this.blockUI.getSettings(),this.blockUISubscription=this.subscribeToBlockUI(this.blockUI.observe())},t.prototype.ngAfterViewInit=function(){try{if(!this.templateCmp)return!1;if(this.templateCmp instanceof o.TemplateRef)this.templateOutlet.createEmbeddedView(this.templateCmp);else{var t=this.resolver.resolveComponentFactory(this.templateCmp);this.templateCompRef=this.templateOutlet.createComponent(t),this.updateBlockTemplate(this.message)}}catch(e){console.error("ng-block-ui:",e)}},t.prototype.ngAfterViewChecked=function(){this.detectChanges()},t.prototype.subscribeToBlockUI=function(t){var e=this;return t.subscribe(function(t){return e.onDispatchedEvent(t)})},t.prototype.onDispatchedEvent=function(t){switch(t.action){case s.START:this.onStart(t);break;case s.STOP:this.onStop(t);break;case s.UPDATE:this.onUpdate(t);break;case s.RESET:this.onReset();break;case s.UNSUBSCRIBE:this.onStop(t),this.onUnsubscribe(t.name)}},t.prototype.onStart=function(t){var e=this,n=t.name,o=t.message;if(n===this.name){var i=this.delayStart||this.settings.delayStart||0;null===this.state.startTimeout&&(0===i?this.showBlock(o):this.state.startTimeout=setTimeout(function(){e.showBlock(o)},i)),this.state.blockCount++,this.updateInstanceBlockCount()}},t.prototype.onStop=function(t){var e=this;if(t.name===this.name){var n=this.delayStop||this.settings.delayStop||0;1<this.state.blockCount?this.state.blockCount--:this.active?null===this.state.stopTimeout&&(0===n?this.hideBlock():this.state.stopTimeout=setTimeout(function(){e.hideBlock()},n)):this.clearState(),this.updateInstanceBlockCount()}},t.prototype.onReset=function(){this.hideBlock()},t.prototype.onUpdate=function(t){var e=this,n=t.name,o=t.message;if(n===this.name){var i=this.delayStart||this.settings.delayStart||0;0===i?this.updateMessage(o):setTimeout(function(){e.updateMessage(o)},i)}},t.prototype.updateMessage=function(t){this.message=t||this.defaultMessage||this.settings.message,this.updateBlockTemplate(this.message),this.detectChanges()},t.prototype.showBlock=function(t){this.active=!0,this.message=t||this.defaultMessage||this.settings.message,this.updateBlockTemplate(this.message),this.detectChanges()},t.prototype.hideBlock=function(){this.clearState(),this.active=!1,this.detectChanges()},t.prototype.clearState=function(){null!=this.state.startTimeout&&clearTimeout(this.state.startTimeout),null!=this.state.stopTimeout&&clearTimeout(this.state.stopTimeout),this.state.blockCount=0,this.state.startTimeout=null,this.state.stopTimeout=null,this.updateInstanceBlockCount()},t.prototype.updateBlockTemplate=function(t){this.templateCompRef&&this.templateCompRef instanceof o.ComponentRef&&(this.templateCompRef.instance.message=t)},t.prototype.onUnsubscribe=function(t){this.blockUISubscription&&t===this.name&&this.blockUISubscription.unsubscribe()},t.prototype.updateInstanceBlockCount=function(){this.blockUI.blockUIInstances[this.name]&&(this.blockUI.blockUIInstances[this.name].blockCount=this.state.blockCount)},t.prototype.detectChanges=function(){this.changeDetectionRef.destroyed||this.changeDetectionRef.detectChanges()},t.prototype.ngOnDestroy=function(){this.onUnsubscribe(this.name)},t.decorators=[{type:o.Component,args:[{selector:"block-ui-content",template:p,encapsulation:o.ViewEncapsulation.None,styles:[l]}]}],t.ctorParameters=function(){return[{type:r},{type:o.ComponentFactoryResolver},{type:o.ChangeDetectorRef}]},t.propDecorators={name:[{type:o.Input}],delayStart:[{type:o.Input}],delayStop:[{type:o.Input}],defaultMessage:[{type:o.Input,args:["message"]}],templateCmp:[{type:o.Input,args:["template"]}],templateOutlet:[{type:o.ViewChild,args:["templateOutlet",{read:o.ViewContainerRef}]}]},t}(),h=function(){function t(t){this.blockUIInstance=t}return t.prototype.start=function(t,e){this.dispatch(t,s.START,e)},t.prototype.stop=function(t){this.dispatch(t,s.STOP)},t.prototype.reset=function(t){this.dispatch(t,s.RESET)},t.prototype.unsubscribe=function(t){this.dispatch(t,s.UNSUBSCRIBE)},t.prototype.isActive=function(t){void 0===t&&(t=null);var e=t?this.toArray(t):null,n=this.blockUIInstance.blockUIInstances;return Object.keys(n).some(function(t){return e?0<=e.indexOf(n[t].name)&&n[t].isActive:n[t].isActive})},t.prototype.dispatch=function(t,e,n){var o=this;void 0===t&&(t=[]),this.toArray(t).forEach(function(t){return o.blockUIInstance.decorate(t)[e](n)})},t.prototype.toArray=function(t){return void 0===t&&(t=[]),"string"==typeof t?[t]:t},t.decorators=[{type:o.Injectable}],t.ctorParameters=function(){return[{type:r}]},t}(),m=function(){function t(t,e,n,o,i){this.blockUIService=t,this.viewRef=e,this.templateRef=n,this.renderer=o,this.componentFactoryResolver=i}return Object.defineProperty(t.prototype,"blockUI",{set:function(t){this.blockTarget=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blockUIMessage",{set:function(t){this.message=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blockUITemplate",{set:function(t){this.template=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blockUIDelayStart",{set:function(t){this.delayStart=t?Number(t):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blockUIDelayStop",{set:function(t){this.delayStop=t?Number(t):null},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){try{this.viewRef.createEmbeddedView(this.templateRef);var t=this.viewRef.element.nativeElement.nextSibling;if(t&&!this.isComponentInTemplate(t)){this.renderer.addClass(t,"block-ui__element"),this.blockUIComponentRef=this.createComponent();var e=this.findContentNode(this.viewRef.element.nativeElement);if(e){var n=this.blockUIService.getSettings();t.appendChild(e),this.blockUIComponentRef.instance.className="block-ui-wrapper--element",this.blockUIComponentRef.instance.name=this.blockTarget||a,this.message&&(this.blockUIComponentRef.instance.defaultMessage=this.message),this.delayStart&&(this.blockUIComponentRef.instance.delayStart=this.delayStart),this.delayStop&&(this.blockUIComponentRef.instance.delayStop=this.delayStop),(this.template||n.template)&&(this.blockUIComponentRef.instance.templateCmp=this.template||n.template)}}}catch(o){console.error("ng-block-ui:",o)}},t.prototype.isComponentInTemplate=function(t){var e=(t||[]).children;return(e=Array.from(e).reverse()).some(function(t){return"block-ui"===t.localName})},t.prototype.findContentNode=function(t){var e=t.nextSibling;return[e,e.nextSibling].find(function(t){return"block-ui-content"===t.localName})},t.prototype.createComponent=function(){var t=this.componentFactoryResolver.resolveComponentFactory(u);return this.viewRef.createComponent(t)},t.decorators=[{type:o.Directive,args:[{selector:"[blockUI]"}]}],t.ctorParameters=function(){return[{type:r},{type:o.ViewContainerRef},{type:o.TemplateRef},{type:o.Renderer2},{type:o.ComponentFactoryResolver}]},t.propDecorators={blockUI:[{type:o.Input}],blockUIMessage:[{type:o.Input}],blockUITemplate:[{type:o.Input}],blockUIDelayStart:[{type:o.Input}],blockUIDelayStop:[{type:o.Input}]},t}(),b=new r,f=new o.InjectionToken("BlockUIModuleSettings");function d(t){return b.updateSettings(t),b}var y=function(){function e(){}return e.forRoot=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[{provide:f,useValue:t},{provide:r,useFactory:d,deps:[f]},h]}},e.decorators=[{type:o.NgModule,args:[{imports:[n.CommonModule],entryComponents:[c,u],declarations:[c,m,u],exports:[c,m,u]}]}],e}();t.BlockUIModule=y,t.BlockUIComponent=c,t.BlockUIContentComponent=u,t.BlockUI=function(o){return function(t,e,n){t[e]=b.decorate(o)}},t.BlockUIService=h,t.BLOCKUI_DEFAULT=a,t.ɵa=f,t.ɵb=d,t.ɵe=l,t.ɵd=p,t.ɵf=m,t.ɵc=r,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ng-block-ui.umd.min.js.map