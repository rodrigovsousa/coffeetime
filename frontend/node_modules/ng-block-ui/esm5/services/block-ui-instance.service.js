/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { ReplaySubject } from 'rxjs';
import { BlockUIActions } from '../constants/block-ui-actions.constant';
import { BlockUIDefaultName } from '../constants/block-ui-default-name.constant';
import * as ɵngcc0 from '@angular/core';
var BlockUIInstanceService = /** @class */ (function () {
    function BlockUIInstanceService() {
        this.blockUISettings = {};
        this.blockUIInstances = {};
        this.blockUISubject = new ReplaySubject();
        this.blockUIObservable = this.blockUISubject.asObservable();
        this.blockUIObservable.subscribe(this.blockUIMiddleware.bind(this));
    }
    /**
     * @return {?}
     */
    BlockUIInstanceService.prototype.getSettings = /**
     * @return {?}
     */
    function () {
        return this.blockUISettings;
    };
    /**
     * @param {?=} settings
     * @return {?}
     */
    BlockUIInstanceService.prototype.updateSettings = /**
     * @param {?=} settings
     * @return {?}
     */
    function (settings) {
        if (settings === void 0) { settings = {}; }
        this.blockUISettings = tslib_1.__assign({}, this.blockUISettings, settings);
    };
    /**
     * @param {?=} name
     * @return {?}
     */
    BlockUIInstanceService.prototype.decorate = /**
     * @param {?=} name
     * @return {?}
     */
    function (name) {
        if (name === void 0) { name = BlockUIDefaultName; }
        var /** @type {?} */ blockUI = /** @type {?} */ ({
            name: name,
            isActive: false,
            blockCount: 0,
            start: this.dispatch(this.blockUISubject, BlockUIActions.START, name),
            update: this.dispatch(this.blockUISubject, BlockUIActions.UPDATE, name),
            stop: this.dispatch(this.blockUISubject, BlockUIActions.STOP, name),
            reset: this.dispatch(this.blockUISubject, BlockUIActions.RESET, name),
            unsubscribe: this.dispatch(this.blockUISubject, BlockUIActions.UNSUBSCRIBE, name)
        });
        this.blockUIInstances[name] = this.blockUIInstances[name] || blockUI;
        return blockUI;
    };
    /**
     * @return {?}
     */
    BlockUIInstanceService.prototype.observe = /**
     * @return {?}
     */
    function () {
        return this.blockUIObservable;
    };
    /**
     * @param {?} __0
     * @return {?}
     */
    BlockUIInstanceService.prototype.blockUIMiddleware = /**
     * @param {?} __0
     * @return {?}
     */
    function (_a) {
        var action = _a.action, name = _a.name;
        var /** @type {?} */ isActive = null;
        switch (action) {
            case (BlockUIActions.START):
                isActive = true;
                break;
            case (BlockUIActions.STOP):
            case (BlockUIActions.RESET):
                isActive = false;
                break;
        }
        if (isActive !== null) {
            this.blockUIInstances[name].isActive = isActive;
        }
    };
    /**
     * @param {?} subject
     * @param {?} action
     * @param {?=} name
     * @return {?}
     */
    BlockUIInstanceService.prototype.dispatch = /**
     * @param {?} subject
     * @param {?} action
     * @param {?=} name
     * @return {?}
     */
    function (subject, action, name) {
        if (name === void 0) { name = BlockUIDefaultName; }
        return function (message) {
            subject.next({
                name: name,
                action: action,
                message: message
            });
        };
    };
    /** @nocollapse */
    BlockUIInstanceService.ctorParameters = function () { return []; };
BlockUIInstanceService.ɵfac = function BlockUIInstanceService_Factory(t) { return new (t || BlockUIInstanceService)(); };
BlockUIInstanceService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: BlockUIInstanceService, factory: function (t) { return BlockUIInstanceService.ɵfac(t); } });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(BlockUIInstanceService, [{
        type: Injectable
    }], function () { return []; }, null); })();
    return BlockUIInstanceService;
}());
export { BlockUIInstanceService };
function BlockUIInstanceService_tsickle_Closure_declarations() {
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUISettings;
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUIInstances;
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUISubject;
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUIObservable;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmxvY2stdWktaW5zdGFuY2Uuc2VydmljZS5qcyIsInNvdXJjZXMiOlsibmc6L25nLWJsb2NrLXVpL3NlcnZpY2VzL2Jsb2NrLXVpLWluc3RhbmNlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBYyxhQUFhLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDakQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBQ3hFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDZDQUE2QyxDQUFDOztBQUNqRjtBQUNJLElBV0Y7QUFDa0IsK0JBTnVCLEVBQUU7QUFDN0MsZ0NBQTBCLEVBQUU7QUFDNUIsOEJBQStDLElBQUksYUFBYSxFQUFFO0FBQ2xFLGlDQUErQyxJQUFJLENBQUMsY0FBYyxDQUFDLFlBQVksRUFBRTtBQUNqRixRQUVJLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ3hFLEtBQUc7QUFDSDtBQUNPO0FBQW1CO0FBQVEsSUFBaEMsNENBQVc7QUFBTztBQUFtQjtBQUNqQyxJQURKO0FBQWMsUUFDWixNQUFNLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQztBQUNoQyxLQUFHO0FBRUg7QUFBUTtBQUE0QjtBQUFtQjtBQUN2RCxJQURFLCtDQUFjO0FBQU87QUFBNEI7QUFDNUM7QUFBUSxJQURiLFVBQWUsUUFBb0M7QUFBSSxRQUF4Qyx5QkFBQSxFQUFBLGFBQW9DO0FBQUksUUFDckQsSUFBSSxDQUFDLGVBQWUsd0JBQVEsSUFBSSxDQUFDLGVBQWUsRUFBSyxRQUFRLENBQUUsQ0FBQztBQUNwRSxLQUFHO0FBRUg7QUFBUTtBQUF3QjtBQUFtQjtBQUNuRCxJQURFLHlDQUFRO0FBQU87QUFBd0I7QUFDeEM7QUFBUSxJQURQ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TSxTQVVLLHNCQUFzQjtBQUNsQztBQUNrQjtBQUNUO0FBQXNEO0FBQy9DO0FBQXVEO0FBRS9EO0FBQ21DO0FBQXFCO0FBSS9EOztBQXJCQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBYUEsQUFMQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBbEVBLEFBQUEsQUFUQSxBQVVBLEFBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBSZXBsYXlTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBCbG9ja1VJQWN0aW9ucyB9IGZyb20gJy4uL2NvbnN0YW50cy9ibG9jay11aS1hY3Rpb25zLmNvbnN0YW50JztcbmltcG9ydCB7IEJsb2NrVUlEZWZhdWx0TmFtZSB9IGZyb20gJy4uL2NvbnN0YW50cy9ibG9jay11aS1kZWZhdWx0LW5hbWUuY29uc3RhbnQnO1xuaW1wb3J0IHsgTmdCbG9ja1VJIH0gZnJvbSAnLi4vbW9kZWxzL2Jsb2NrLXVpLm1vZGVsJztcbmltcG9ydCB7IEJsb2NrVUlTZXR0aW5ncyB9IGZyb20gJy4uL21vZGVscy9ibG9jay11aS1zZXR0aW5ncy5tb2RlbCc7XG5pbXBvcnQgeyBCbG9ja1VJRXZlbnQgfSBmcm9tICcuLi9tb2RlbHMvYmxvY2stdWktZXZlbnQubW9kZWwnO1xuXG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBCbG9ja1VJSW5zdGFuY2VTZXJ2aWNlIHtcbiAgYmxvY2tVSVNldHRpbmdzOiBCbG9ja1VJU2V0dGluZ3MgfCBhbnkgPSB7fTtcbiAgYmxvY2tVSUluc3RhbmNlczogYW55ID0ge307XG4gIHByaXZhdGUgYmxvY2tVSVN1YmplY3Q6IFJlcGxheVN1YmplY3Q8YW55PiA9IG5ldyBSZXBsYXlTdWJqZWN0KCk7XG4gIHByaXZhdGUgYmxvY2tVSU9ic2VydmFibGU6IE9ic2VydmFibGU8YW55PiA9IHRoaXMuYmxvY2tVSVN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5ibG9ja1VJT2JzZXJ2YWJsZS5zdWJzY3JpYmUodGhpcy5ibG9ja1VJTWlkZGxld2FyZS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIGdldFNldHRpbmdzKCk6IEJsb2NrVUlTZXR0aW5ncyB8IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuYmxvY2tVSVNldHRpbmdzO1xuICB9XG5cbiAgdXBkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IEJsb2NrVUlTZXR0aW5ncyB8IGFueSA9IHt9KTogdm9pZCB7XG4gICAgdGhpcy5ibG9ja1VJU2V0dGluZ3MgPSB7IC4uLnRoaXMuYmxvY2tVSVNldHRpbmdzLCAuLi5zZXR0aW5ncyB9O1xuICB9XG5cbiAgZGVjb3JhdGUobmFtZTogc3RyaW5nID0gQmxvY2tVSURlZmF1bHROYW1lKTogTmdCbG9ja1VJIHtcbiAgICBjb25zdCBibG9ja1VJID0ge1xuICAgICAgbmFtZSxcbiAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgIGJsb2NrQ291bnQ6IDAsXG4gICAgICBzdGFydDogdGhpcy5kaXNwYXRjaCh0aGlzLmJsb2NrVUlTdWJqZWN0LCBCbG9ja1VJQWN0aW9ucy5TVEFSVCwgbmFtZSksXG4gICAgICB1cGRhdGU6IHRoaXMuZGlzcGF0Y2godGhpcy5ibG9ja1VJU3ViamVjdCwgQmxvY2tVSUFjdGlvbnMuVVBEQVRFLCBuYW1lKSxcbiAgICAgIHN0b3A6IHRoaXMuZGlzcGF0Y2godGhpcy5ibG9ja1VJU3ViamVjdCwgQmxvY2tVSUFjdGlvbnMuU1RPUCwgbmFtZSksXG4gICAgICByZXNldDogdGhpcy5kaXNwYXRjaCh0aGlzLmJsb2NrVUlTdWJqZWN0LCBCbG9ja1VJQWN0aW9ucy5SRVNFVCwgbmFtZSksXG4gICAgICB1bnN1YnNjcmliZTogdGhpcy5kaXNwYXRjaCh0aGlzLmJsb2NrVUlTdWJqZWN0LCBCbG9ja1VJQWN0aW9ucy5VTlNVQlNDUklCRSwgbmFtZSlcbiAgICB9IGFzIE5nQmxvY2tVSTtcblxuICAgIHRoaXMuYmxvY2tVSUluc3RhbmNlc1tuYW1lXSA9IHRoaXMuYmxvY2tVSUluc3RhbmNlc1tuYW1lXSB8fCBibG9ja1VJO1xuXG4gICAgcmV0dXJuIGJsb2NrVUk7XG4gIH1cblxuICBvYnNlcnZlKCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuYmxvY2tVSU9ic2VydmFibGU7XG4gIH1cblxuICBwcml2YXRlIGJsb2NrVUlNaWRkbGV3YXJlKHsgYWN0aW9uLCBuYW1lIH06IEJsb2NrVUlFdmVudCk6IHZvaWQge1xuICAgIGxldCBpc0FjdGl2ZTogYm9vbGVhbiA9IG51bGw7XG5cbiAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgY2FzZSAoQmxvY2tVSUFjdGlvbnMuU1RBUlQpOlxuICAgICAgICBpc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIChCbG9ja1VJQWN0aW9ucy5TVE9QKTpcbiAgICAgIGNhc2UgKEJsb2NrVUlBY3Rpb25zLlJFU0VUKTpcbiAgICAgICAgaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgaWYgKGlzQWN0aXZlICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmJsb2NrVUlJbnN0YW5jZXNbbmFtZV0uaXNBY3RpdmUgPSBpc0FjdGl2ZTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRpc3BhdGNoKHN1YmplY3Q6IFJlcGxheVN1YmplY3Q8YW55PiwgYWN0aW9uOiBCbG9ja1VJQWN0aW9ucywgbmFtZTogc3RyaW5nID0gQmxvY2tVSURlZmF1bHROYW1lKTogRnVuY3Rpb24ge1xuICAgIHJldHVybiAobWVzc2FnZT86IGFueSk6IHZvaWQgPT4ge1xuICAgICAgc3ViamVjdC5uZXh0KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWN0aW9uLFxuICAgICAgICBtZXNzYWdlXG4gICAgICB9KTtcbiAgICB9O1xuICB9XG59XG4iXX0=