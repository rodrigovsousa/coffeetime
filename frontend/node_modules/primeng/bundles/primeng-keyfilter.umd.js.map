{"version":3,"file":"primeng-keyfilter.umd.js","sources":["ng:/primeng/keyfilter/keyfilter.ts"],"names":["NG_VALIDATORS","forwardRef","EventEmitter","DomHandler","ElementRef","Input","Output","HostListener","Directive","NgModule","CommonModule"],"mappings":"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","sourcesContent":["import { NgModule, Directive, ElementRef, HostListener, Input, forwardRef, Output, EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DomHandler } from 'primeng/dom';\nimport { Validator, AbstractControl, NG_VALIDATORS } from '@angular/forms';\n\nexport const KEYFILTER_VALIDATOR: any = {\n    provide: NG_VALIDATORS,\n    useExisting: forwardRef(() => KeyFilter),\n    multi: true\n};\n\nconst DEFAULT_MASKS = {\n    pint: /[\\d]/,\n    'int': /[\\d\\-]/,\n    pnum: /[\\d\\.]/,\n    money: /[\\d\\.\\s,]/,\n    num: /[\\d\\-\\.]/,\n    hex: /[0-9a-f]/i,\n    email: /[a-z0-9_\\.\\-@]/i,\n    alpha: /[a-z_]/i,\n    alphanum: /[a-z0-9_]/i\n};\n\nconst KEYS = {\n    TAB: 9,\n    RETURN: 13,\n    ESC: 27,\n    BACKSPACE: 8,\n    DELETE: 46\n};\n\nconst SAFARI_KEYS = {\n    63234: 37, // left\n    63235: 39, // right\n    63232: 38, // up\n    63233: 40, // down\n    63276: 33, // page up\n    63277: 34, // page down\n    63272: 46, // delete\n    63273: 36, // home\n    63275: 35  // end\n};\n\n@Directive({\n    selector: '[pKeyFilter]',\n    providers: [KEYFILTER_VALIDATOR]\n})\nexport class KeyFilter implements Validator {\n\n    @Input() pValidateOnly: boolean;\n\n    @Output() ngModelChange: EventEmitter<any> = new EventEmitter();\n\n    regex: RegExp;\n\n    _pattern: any;\n\n    isAndroid: boolean;\n\n    lastValue: any;\n\n    constructor(public el: ElementRef) {\n        this.isAndroid = DomHandler.isAndroid();\n    }\n\n    get pattern(): any {\n        return this._pattern;\n    }\n\n    @Input('pKeyFilter') set pattern(_pattern: any) {\n        this._pattern = _pattern;\n        this.regex = DEFAULT_MASKS[this._pattern] || this._pattern;\n    }\n\n    isNavKeyPress(e: KeyboardEvent) {\n        let k = e.keyCode;\n        k = DomHandler.getBrowser().safari ? (SAFARI_KEYS[k] || k) : k;\n\n        return (k >= 33 && k <= 40) || k == KEYS.RETURN || k == KEYS.TAB || k == KEYS.ESC;\n    };\n\n    isSpecialKey(e: KeyboardEvent) {\n        let k = e.keyCode || e.charCode;\n\n        return k == 9 || k == 13 || k == 27 || k == 16 || k == 17 ||(k >= 18 && k <= 20) ||\n            (DomHandler.getBrowser().opera && !e.shiftKey && (k == 8 || (k >= 33 && k <= 35) || (k >= 36 && k <= 39) || (k >= 44 && k <= 45)));\n    }\n\n\n    getKey(e: KeyboardEvent) {\n        let k = e.keyCode || e.charCode;\n        return DomHandler.getBrowser().safari ? (SAFARI_KEYS[k] || k) : k;\n    }\n\n    getCharCode(e: KeyboardEvent) {\n        return e.charCode || e.keyCode || e.which;\n    }\n\n    findDelta(value: string, prevValue: string) {\n        let delta = '';\n\n        for (let i = 0; i < value.length; i++) {\n            let str = value.substr(0, i) + value.substr(i + value.length - prevValue.length);\n\n            if (str === prevValue)\n                delta = value.substr(i, value.length - prevValue.length);\n        }\n\n        return delta;\n    }\n\n    isValidChar(c: string) {\n        return this.regex.test(c);\n    }\n\n    isValidString(str: string) {\n        for (let i = 0; i < str.length; i++) {\n            if (!this.isValidChar(str.substr(i, 1))) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    @HostListener('input', ['$event'])\n    onInput(e: KeyboardEvent) {\n        if (this.isAndroid && !this.pValidateOnly) {\n            let val = this.el.nativeElement.value;\n            let lastVal = this.lastValue || '';\n\n            let inserted = this.findDelta(val, lastVal);\n            let removed = this.findDelta(lastVal, val);\n            let pasted = inserted.length > 1 || (!inserted && !removed);\n\n            if (pasted) {\n                if (!this.isValidString(val)) {\n                    this.el.nativeElement.value = lastVal;\n                    this.ngModelChange.emit(lastVal);\n                }\n            }\n            else if (!removed) {\n                if (!this.isValidChar(inserted)) {\n                    this.el.nativeElement.value = lastVal;\n                    this.ngModelChange.emit(lastVal);\n                }\n            }\n\n            val = this.el.nativeElement.value;\n            if (this.isValidString(val)) {\n                this.lastValue = val;\n            }\n        }\n    }\n\n    @HostListener('keypress', ['$event'])\n    onKeyPress(e: KeyboardEvent) {\n        if (this.isAndroid || this.pValidateOnly) {\n            return;\n        }\n\n        let browser = DomHandler.getBrowser();\n        let k = this.getKey(e);\n\n        if (browser.mozilla && (e.ctrlKey || e.altKey)) {\n            return;\n        }\n        else if (k == 17 || k == 18) {\n            return;\n        }\n\n        let c = this.getCharCode(e);\n        let cc = String.fromCharCode(c);\n        let ok = true;\n\n        if (!browser.mozilla && (this.isSpecialKey(e) || !cc)) {\n            return;\n        }\n\n        ok = this.regex.test(cc);\n\n        if (!ok) {\n            e.preventDefault();\n        }\n    }\n\n    @HostListener('paste', ['$event'])\n    onPaste(e) {\n        const clipboardData = e.clipboardData || (<any>window).clipboardData.getData('text');\n        if (clipboardData) {\n            const pastedText = clipboardData.getData('text');\n            for (let char of pastedText.toString()) {\n                if (!this.regex.test(char)) {\n                    e.preventDefault();\n                    return;\n                }\n            }\n        }\n    }\n\n    validate(c: AbstractControl): { [key: string]: any } {\n        if (this.pValidateOnly) {\n            let value = this.el.nativeElement.value;\n            if (value && !this.regex.test(value)) {\n                return {\n                    validatePattern: false\n                }\n            }\n        }\n    }\n\n}\n\n@NgModule({\n    imports: [CommonModule],\n    exports: [KeyFilter],\n    declarations: [KeyFilter]\n})\nexport class KeyFilterModule { }\n"]}